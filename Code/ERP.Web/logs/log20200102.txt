2020-01-02 08:28:52,661 [6268] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-02 08:28:52,727 [6268] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-02 08:28:52,732 [6268] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-02 08:28:52,737 [6268] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-02 08:29:27,458 [6020] DEBUG Servicesys_user - 获取实体对象
2020-01-02 08:29:27,481 [6020] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  '1234'and IsEnable =  'True'
2020-01-02 08:29:27,620 [6020] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'admin' 
2020-01-02 08:29:27,704 [6020] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('admin','管理员','WIN-3S9VPNGGB1T','localhost','上海市','2020-01-02 08:29:27')
2020-01-02 08:29:27,709 [6020] DEBUG Servicemms_project - 获取实体对象
2020-01-02 08:29:27,710 [6020] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2020-01-02 08:29:27,780 [10044] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2020-01-02 08:29:30,577 [6020] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-02 08:29:59,463 [9332] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2020-01-02 08:29:59,498 [9332] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-02 08:29:59,500 [9332] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-02 08:29:59,503 [9332] DEBUG Servicesys_code - 获取动态列表
2020-01-02 08:29:59,503 [9332] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-02 08:30:01,320 [10044] DEBUG Servicemms_receive - 获取动态列表
2020-01-02 08:30:01,321 [10044] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-02 08:30:01,364 [10044] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-02 08:30:34,434 [9204] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/report/balanceaccount')
2020-01-02 08:30:34,450 [9204] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-02 08:30:34,451 [9204] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-02 08:30:34,453 [9204] DEBUG Servicemms_buildPart - 获取动态列表
2020-01-02 08:30:34,453 [9204] DEBUG Mms - select BuildPartCode as value,BuildPartName as text from mms_buildPart where  ProjectCode =  '201306030001'
2020-01-02 08:30:35,625 [6020] DEBUG Mms - 
Select PickUnitName
From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030001'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030001'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'
) as t
Where PickUnitName<>'' and PickUnitName<>'其他' and PickUnitName<>'租赁进场'
group by PickUnitName
                
2020-01-02 08:30:35,739 [6020] DEBUG Mms - 
Select MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else 0 end),0) as ReceiveMoney --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Money else 0 end),0) as StockSelfMoney --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Money else 0 end),0) as OwnerSupplyMoney --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Money else 0 end),0) as CallInMoney --调入
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Money else 0 end),0) as ReceiveOtherMoney --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else 0 end),0) as ReceiveNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Num else 0 end),0) as StockSelfNum --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Num else 0 end),0) as OwnerSupplyNum --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Num else 0 end),0) as CallInNum --调入
	,ISNULL(Sum(CASE WHEN SupplyType='租赁进场' then Num else 0 end),0) as ReceiveRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Num else 0 end),0) as ReceiveOtherNum --其他

    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Money else 0 end),0) as SendMoney --合计
    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Num else 0 end),0) as SendNum --合计
     ,ISNULL(Sum(CASE WHEN PickUnitName='北京士兴钢结构有限公司' then Num else 0 end),0) as PickUnitNum0 ,ISNULL(Sum(CASE WHEN PickUnitName='北京士兴钢结构有限公司' then Money else 0 end),0) as PickUnitMoney0 ,ISNULL(Sum(CASE WHEN PickUnitName='河北天强建筑工程有限公司' then Num else 0 end),0) as PickUnitNum1 ,ISNULL(Sum(CASE WHEN PickUnitName='河北天强建筑工程有限公司' then Money else 0 end),0) as PickUnitMoney1                                                             --领料人生成的列
    ,ISNULL(Sum(CASE WHEN PickUnitName='租赁进场' then Num else 0 end),0) as SendRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Money else 0 end),0) as SendOtherMoney --其他
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Num else 0 end),0) as SendOtherNum --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else -Num end),0) as TotalNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else -Money end),0) as TotalMoney --合计

From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030001'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030001'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'
) as t
group by MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit

2020-01-02 08:30:35,989 [6020] DEBUG Mms - 
Select mms_warehouseStockHistory.MaterialCode,sum(Num) As InitNum,sum(UnitPrice*Num) As InitMoney
From mms_warehouseStockHistory
Left join mms_warehouse on mms_warehouse.warehouseCode=mms_warehouseStockHistory.warehouseCode
Left join mms_material on mms_material.MaterialCode=mms_warehouseStockHistory.MaterialCode
Where 1=1  And  mms_warehouse.ProjectCode='201306030001'
group by mms_warehouseStockHistory.MaterialCode

2020-01-02 08:36:06,214 [4596] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2020-01-02 08:36:06,217 [4596] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-02 08:36:06,217 [4596] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-02 08:36:06,218 [4596] DEBUG Servicesys_code - 获取动态列表
2020-01-02 08:36:06,218 [4596] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-02 08:36:06,910 [5644] DEBUG Servicemms_receive - 获取动态列表
2020-01-02 08:36:06,910 [5644] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-02 08:36:06,913 [5644] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-02 09:05:29,676 [9572] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2020-01-02 09:05:29,679 [9572] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-02 09:05:29,686 [9572] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-02 09:05:29,686 [9572] DEBUG Servicesys_code - 获取动态列表
2020-01-02 09:05:29,686 [9572] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-02 09:05:30,620 [1620] DEBUG Servicemms_receive - 获取动态列表
2020-01-02 09:05:30,620 [1620] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-02 09:05:30,623 [1620] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-02 09:05:32,131 [9572] DEBUG Servicemms_receive - 获取动态列表
2020-01-02 09:05:32,132 [9572] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-02 09:05:32,136 [9572] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-02 09:05:33,159 [1620] DEBUG Servicemms_receive - 获取动态列表
2020-01-02 09:05:33,159 [1620] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-02 09:05:33,161 [1620] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-02 09:07:53,835 [3892] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/direct/Index','/Mms/direct')
2020-01-02 09:07:53,850 [3892] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-02 09:07:53,851 [3892] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-02 09:07:53,852 [3892] DEBUG Servicesys_code - 获取动态列表
2020-01-02 09:07:53,852 [3892] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-02 09:07:55,386 [532] DEBUG Servicemms_direct - 获取动态列表
2020-01-02 09:07:55,386 [532] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName,D.MerchantsName as SupplierName,E.MerchantsName as PickUnitName
     from 
        mms_direct A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_merchants     D on D.MerchantsCode    = A.SupplierCode
        left join mms_merchants     E on E.MerchantsCode    = A.PickUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-02 09:07:55,413 [532] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName,D.MerchantsName as SupplierName,E.MerchantsName as PickUnitName
     from 
        mms_direct A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_merchants     D on D.MerchantsCode    = A.SupplierCode
        left join mms_merchants     E on E.MerchantsCode    = A.PickUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-02 09:07:56,315 [1704] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/rentin/Index','/Mms/rentin')
2020-01-02 09:07:56,332 [1704] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-02 09:07:56,332 [1704] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-02 09:07:57,692 [3892] DEBUG Servicemms_rentIn - 获取动态列表
2020-01-02 09:07:57,693 [3892] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MerchantsName
     from 
        mms_rentIn A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_merchants     C on C.MerchantsCode    = A.SupplierCode
     order by A.BillNo
2020-01-02 09:07:57,710 [3892] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MerchantsName
     from 
        mms_rentIn A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_merchants     C on C.MerchantsCode    = A.SupplierCode
     ) tb_temp
2020-01-02 09:07:59,950 [532] DEBUG Servicemms_rentIn - 获取动态列表
2020-01-02 09:07:59,950 [532] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MerchantsName
     from 
        mms_rentIn A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_merchants     C on C.MerchantsCode    = A.SupplierCode
     order by  C.MerchantsName asc
2020-01-02 09:07:59,963 [532] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MerchantsName
     from 
        mms_rentIn A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_merchants     C on C.MerchantsCode    = A.SupplierCode
     ) tb_temp
2020-01-02 09:08:02,055 [11108] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/rentin/edit')
2020-01-02 09:08:02,068 [11108] DEBUG Servicemms_rentIn - 获取实体对象
2020-01-02 09:08:02,069 [11108] DEBUG Mms - select mms_rentIn.* from mms_rentIn where  BillNo =  '201307230002'
2020-01-02 09:08:02,074 [11108] DEBUG Servicemms_rentIn - 获取上一条下一条数据
2020-01-02 09:08:02,109 [11108] DEBUG Servicemms_rentIn - 获取字段
2020-01-02 09:08:02,111 [11108] DEBUG Mms - select top 1 BillNo from mms_rentIn where  ProjectCode =  '201306030001' order by BillNo
2020-01-02 09:08:02,117 [11108] DEBUG Servicemms_rentIn - 获取字段
2020-01-02 09:08:02,117 [11108] DEBUG Mms - select top 1 BillNo from mms_rentIn where  BillNo < '201307230002'and ProjectCode =  '201306030001' order by BillNo desc
2020-01-02 09:08:02,122 [11108] DEBUG Servicemms_rentIn - 获取字段
2020-01-02 09:08:02,122 [11108] DEBUG Mms - select top 1 BillNo from mms_rentIn where  BillNo >  '201307230002'and ProjectCode =  '201306030001' order by BillNo
2020-01-02 09:08:02,126 [11108] DEBUG Servicemms_rentIn - 获取字段
2020-01-02 09:08:02,127 [11108] DEBUG Mms - select top 1 BillNo from mms_rentIn where  ProjectCode =  '201306030001' order by BillNo desc
2020-01-02 09:08:02,180 [11108] DEBUG Servicesys_code - 获取动态列表
2020-01-02 09:08:02,180 [11108] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2020-01-02 09:08:02,183 [11108] DEBUG Servicesys_code - 获取动态列表
2020-01-02 09:08:02,183 [11108] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2020-01-02 09:08:02,184 [11108] DEBUG Servicesys_code - 获取动态列表
2020-01-02 09:08:02,184 [11108] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'BillingUnit'
2020-01-02 09:08:02,186 [11108] DEBUG Servicesys_code - 获取字段
2020-01-02 09:08:02,186 [11108] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'MaterialUse'and IsEnable =  'True'and IsDefault =  'True'
2020-01-02 09:08:03,283 [3892] DEBUG ServiceModelBase - 获取动态列表
2020-01-02 09:08:03,283 [3892] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('CG00303') order by MerchantsCode
2020-01-02 09:08:03,985 [1620] DEBUG Servicemms_rentIn - 获取动态列表
2020-01-02 09:08:03,986 [1620] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material,C.MerchantsName as UseUnitName
     from 
        mms_rentInDetail A
        left join mms_material B on B.MaterialCode      = A.MaterialCode
        left join mms_merchants C on C.MerchantsCode    = A.UseUnit
     where  BillNo =  '201307230002' order by A.MaterialCode
2020-01-02 09:08:35,173 [1620] DEBUG ServiceModelBase - 获取动态列表
2020-01-02 09:08:35,173 [1620] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('CG00303') order by MerchantsCode
2020-01-02 09:08:35,332 [3892] DEBUG Mms - update mms_rentIn set [ApproveState] = 'reject', [ApproveRemark] = '', [ApprovePerson] = '管理员', [ApproveDate] = '2020-01-02 09:08:35' where  BillNo =  '201307230002'
2020-01-02 09:08:39,091 [11108] DEBUG ServiceModelBase - 获取动态列表
2020-01-02 09:08:39,095 [11108] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('CG00303') order by MerchantsCode
2020-01-02 09:08:39,150 [9572] DEBUG Mms - update mms_rentIn set [ApproveState] = 'passed', [ApproveRemark] = '', [ApprovePerson] = '管理员', [ApproveDate] = '2020-01-02 09:08:39' where  BillNo =  '201307230002'
2020-01-02 09:08:57,514 [9572] DEBUG Servicemms_direct - 获取动态列表
2020-01-02 09:08:57,515 [9572] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName,D.MerchantsName as SupplierName,E.MerchantsName as PickUnitName
     from 
        mms_direct A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_merchants     D on D.MerchantsCode    = A.SupplierCode
        left join mms_merchants     E on E.MerchantsCode    = A.PickUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-02 09:08:57,517 [9572] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName,D.MerchantsName as SupplierName,E.MerchantsName as PickUnitName
     from 
        mms_direct A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_merchants     D on D.MerchantsCode    = A.SupplierCode
        left join mms_merchants     E on E.MerchantsCode    = A.PickUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-02 09:09:18,309 [1620] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2020-01-02 09:09:20,071 [1704] DEBUG Servicesys_menu - 获取动态列表
2020-01-02 09:09:20,072 [1704] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2020-01-02 09:10:35,218 [9572] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/transfer/Index','/Mms/transfer')
2020-01-02 09:10:35,230 [9572] DEBUG Servicesys_code - 获取动态列表
2020-01-02 09:10:35,231 [9572] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2020-01-02 09:10:35,232 [9572] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-02 09:10:35,233 [9572] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-02 09:10:36,822 [1704] DEBUG Servicemms_transfer - 获取动态列表
2020-01-02 09:10:36,823 [1704] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as ReceiveUnitName
     from 
        mms_transfer A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.ReceiveUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-02 09:10:36,851 [1704] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as ReceiveUnitName
     from 
        mms_transfer A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.ReceiveUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-02 09:10:40,588 [9572] DEBUG Servicemms_transfer - 获取新主键
2020-01-02 09:10:40,590 [9572] DEBUG Mms - select isnull(max(BillNo),0) from mms_transfer
2020-01-02 09:10:40,650 [1620] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/transfer/edit')
2020-01-02 09:10:40,669 [1620] DEBUG Servicemms_transfer - 获取实体对象
2020-01-02 09:10:40,670 [1620] DEBUG Mms - select mms_transfer.* from mms_transfer where  BillNo =  '202001020001'
2020-01-02 09:10:40,679 [1620] DEBUG Servicemms_transfer - 获取上一条下一条数据
2020-01-02 09:10:40,682 [1620] DEBUG Servicemms_transfer - 获取字段
2020-01-02 09:10:40,682 [1620] DEBUG Mms - select top 1 BillNo from mms_transfer where  ProjectCode =  '201306030001' order by BillNo
2020-01-02 09:10:40,687 [1620] DEBUG Servicemms_transfer - 获取字段
2020-01-02 09:10:40,687 [1620] DEBUG Mms - select top 1 BillNo from mms_transfer where  BillNo < '202001020001'and ProjectCode =  '201306030001' order by BillNo desc
2020-01-02 09:10:40,691 [1620] DEBUG Servicemms_transfer - 获取字段
2020-01-02 09:10:40,691 [1620] DEBUG Mms - select top 1 BillNo from mms_transfer where  BillNo >  '202001020001'and ProjectCode =  '201306030001' order by BillNo
2020-01-02 09:10:40,694 [1620] DEBUG Servicemms_transfer - 获取字段
2020-01-02 09:10:40,695 [1620] DEBUG Mms - select top 1 BillNo from mms_transfer where  ProjectCode =  '201306030001' order by BillNo desc
2020-01-02 09:10:40,731 [1620] DEBUG Servicesys_code - 获取动态列表
2020-01-02 09:10:40,731 [1620] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2020-01-02 09:10:40,732 [1620] DEBUG Servicesys_code - 获取动态列表
2020-01-02 09:10:40,732 [1620] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-02 09:10:40,733 [1620] DEBUG Servicesys_code - 获取动态列表
2020-01-02 09:10:40,733 [1620] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2020-01-02 09:10:40,734 [1620] DEBUG Servicesys_code - 获取动态列表
2020-01-02 09:10:40,734 [1620] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2020-01-02 09:10:40,735 [1620] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-02 09:10:40,735 [1620] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-02 09:10:40,736 [1620] DEBUG Servicesys_code - 获取字段
2020-01-02 09:10:40,736 [1620] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'Pricing'and IsEnable =  'True'and IsDefault =  'True'
2020-01-02 09:10:42,556 [1704] DEBUG Servicemms_transferDetail - 获取动态列表
2020-01-02 09:10:42,557 [1704] DEBUG Mms - select 
        A.*, C.MaterialName,C.Model,C.Material,D.Num as StockNum,D.UnitPrice as StockUnitPrice,T.RemainNum,T.SrcUnitPrice
     from 
        mms_transferDetail A
        left join mms_transfer B on B.BillNo = A.BillNo
        left join mms_material C on C.MaterialCode = A.MaterialCode
        left join mms_warehouseStock D on D.WarehouseCode = B.WarehouseCode and D.MaterialCode = A.MaterialCode
        left join ( 
    select 'receive' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.ReceiveDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_receiveDetail as A
    left join mms_receive as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode

    union

    select 'refund' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.RefundDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_refundDetail as A
    left join mms_refund as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode

    union

    select 'adjust' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.EffectDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_stockAdjustDetail as A
    left join mms_stockAdjust as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
 ) T on T.SrcBillType=A.SrcBillType and T.SrcBillNo=A.SrcBillNo and T.SrcRowId = A.SrcRowId
     where  A.BillNo =  '202001020001' order by A.RowId
2020-01-02 09:15:28,779 [10156] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/organize/Index','/Sys/organize')
2020-01-02 09:15:28,798 [10156] DEBUG Servicesys_organize - 获取实体列表
2020-01-02 09:15:28,801 [10156] DEBUG Sys - select sys_organize.* from sys_organize
2020-01-02 09:15:49,019 [10156] DEBUG Servicesys_organize - 编辑记录
2020-01-02 09:15:49,033 [10156] DEBUG Servicesys_organize - 获取动态对象
2020-01-02 09:15:49,036 [10156] DEBUG Sys - select 
        sys_organize
    .* from 
        sys_organize
     where  OrganizeCode =  '04060501'
2020-01-02 09:15:49,044 [10156] DEBUG Sys - update 
        sys_organize
     set [ParentCode] = '040605', [OrganizeCode] = '04060501', [OrganizeName] = '上海德川集团', [UpdatePerson] = '管理员', [UpdateDate] = '2020-01-02 09:15:49' where  OrganizeCode =  '04060501'
2020-01-02 09:15:49,059 [10156] DEBUG Sys - insert into 
        sys_organize
    ([ParentCode],[OrganizeCode],[OrganizeName],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('040605','04060501','上海德川集团','管理员','2020-01-02 09:15:49','管理员','2020-01-02 09:15:49')
2020-01-02 09:15:49,103 [10156] DEBUG Servicesys_organize - 获取实体列表
2020-01-02 09:15:49,103 [10156] DEBUG Sys - select sys_organize.* from sys_organize
2020-01-02 09:16:05,248 [11172] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_organizeRoleMap B on B.RoleCode = A.RoleCode and B.OrganizeCode = '040605'
2020-01-02 09:26:48,095 [4844] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2020-01-02 09:26:49,521 [10104] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-02 09:26:49,860 [6352] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/transfer/Index','/Mms/transfer')
2020-01-02 09:26:49,862 [6352] DEBUG Servicesys_code - 获取动态列表
2020-01-02 09:26:49,862 [6352] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2020-01-02 09:26:49,865 [6352] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-02 09:26:49,870 [6352] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-02 09:26:50,868 [6352] DEBUG Servicemms_transfer - 获取动态列表
2020-01-02 09:26:50,868 [6352] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as ReceiveUnitName
     from 
        mms_transfer A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.ReceiveUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-02 09:26:50,869 [6352] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as ReceiveUnitName
     from 
        mms_transfer A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.ReceiveUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-02 09:27:38,618 [4844] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2020-01-02 09:27:39,781 [6724] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-02 09:27:40,079 [11456] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/transfer/Index','/Mms/transfer')
2020-01-02 09:27:40,084 [11456] DEBUG Servicesys_code - 获取动态列表
2020-01-02 09:27:40,084 [11456] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2020-01-02 09:27:40,088 [11456] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-02 09:27:40,088 [11456] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-02 09:27:41,068 [6352] DEBUG Servicemms_transfer - 获取动态列表
2020-01-02 09:27:41,069 [6352] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as ReceiveUnitName
     from 
        mms_transfer A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.ReceiveUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-02 09:27:41,074 [6352] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as ReceiveUnitName
     from 
        mms_transfer A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.ReceiveUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-02 09:28:33,303 [11456] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2020-01-02 09:28:33,601 [11608] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-02 09:28:34,097 [6724] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/transfer/Index','/Mms/transfer')
2020-01-02 09:28:34,100 [6724] DEBUG Servicesys_code - 获取动态列表
2020-01-02 09:28:34,101 [6724] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2020-01-02 09:28:34,101 [6724] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-02 09:28:34,102 [6724] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-02 09:28:35,019 [4844] DEBUG Servicemms_transfer - 获取动态列表
2020-01-02 09:28:35,020 [4844] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as ReceiveUnitName
     from 
        mms_transfer A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.ReceiveUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-02 09:28:35,023 [4844] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as ReceiveUnitName
     from 
        mms_transfer A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.ReceiveUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-02 09:29:15,442 [11456] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/report/balanceaccount')
2020-01-02 09:29:15,445 [11456] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-02 09:29:15,445 [11456] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-02 09:29:15,446 [11456] DEBUG Servicemms_buildPart - 获取动态列表
2020-01-02 09:29:15,446 [11456] DEBUG Mms - select BuildPartCode as value,BuildPartName as text from mms_buildPart where  ProjectCode =  '201306030001'
2020-01-02 09:29:15,675 [11608] DEBUG Mms - 
Select PickUnitName
From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030001'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030001'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'
) as t
Where PickUnitName<>'' and PickUnitName<>'其他' and PickUnitName<>'租赁进场'
group by PickUnitName
                
2020-01-02 09:29:15,681 [11608] DEBUG Mms - 
Select MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else 0 end),0) as ReceiveMoney --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Money else 0 end),0) as StockSelfMoney --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Money else 0 end),0) as OwnerSupplyMoney --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Money else 0 end),0) as CallInMoney --调入
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Money else 0 end),0) as ReceiveOtherMoney --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else 0 end),0) as ReceiveNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Num else 0 end),0) as StockSelfNum --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Num else 0 end),0) as OwnerSupplyNum --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Num else 0 end),0) as CallInNum --调入
	,ISNULL(Sum(CASE WHEN SupplyType='租赁进场' then Num else 0 end),0) as ReceiveRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Num else 0 end),0) as ReceiveOtherNum --其他

    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Money else 0 end),0) as SendMoney --合计
    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Num else 0 end),0) as SendNum --合计
     ,ISNULL(Sum(CASE WHEN PickUnitName='北京士兴钢结构有限公司' then Num else 0 end),0) as PickUnitNum0 ,ISNULL(Sum(CASE WHEN PickUnitName='北京士兴钢结构有限公司' then Money else 0 end),0) as PickUnitMoney0 ,ISNULL(Sum(CASE WHEN PickUnitName='河北天强建筑工程有限公司' then Num else 0 end),0) as PickUnitNum1 ,ISNULL(Sum(CASE WHEN PickUnitName='河北天强建筑工程有限公司' then Money else 0 end),0) as PickUnitMoney1                                                             --领料人生成的列
    ,ISNULL(Sum(CASE WHEN PickUnitName='租赁进场' then Num else 0 end),0) as SendRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Money else 0 end),0) as SendOtherMoney --其他
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Num else 0 end),0) as SendOtherNum --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else -Num end),0) as TotalNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else -Money end),0) as TotalMoney --合计

From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030001'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030001'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'
) as t
group by MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit

2020-01-02 09:29:15,689 [11608] DEBUG Mms - 
Select mms_warehouseStockHistory.MaterialCode,sum(Num) As InitNum,sum(UnitPrice*Num) As InitMoney
From mms_warehouseStockHistory
Left join mms_warehouse on mms_warehouse.warehouseCode=mms_warehouseStockHistory.warehouseCode
Left join mms_material on mms_material.MaterialCode=mms_warehouseStockHistory.MaterialCode
Where 1=1  And  mms_warehouse.ProjectCode='201306030001'
group by mms_warehouseStockHistory.MaterialCode

2020-01-02 09:32:35,723 [4844] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/rentoff/Index','/Mms/rentoff')
2020-01-02 09:32:35,740 [4844] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-02 09:32:35,741 [4844] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-02 09:32:37,273 [11948] DEBUG Servicemms_rentOff - 获取动态列表
2020-01-02 09:32:37,274 [11948] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MerchantsName
     from 
        mms_rentOff A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_merchants     C on C.MerchantsCode    = A.SupplierCode
     order by A.BillNo
2020-01-02 09:32:37,299 [11948] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MerchantsName
     from 
        mms_rentOff A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_merchants     C on C.MerchantsCode    = A.SupplierCode
     ) tb_temp
2020-01-02 09:36:02,330 [8852] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/user/Index','/Sys/user')
2020-01-02 09:36:03,485 [6484] DEBUG Servicesys_organize - 获取实体列表
2020-01-02 09:36:03,485 [6484] DEBUG Sys - select sys_organize.* from sys_organize
2020-01-02 09:36:03,684 [6580] DEBUG Servicesys_user - 获取实体列表
2020-01-02 09:36:03,686 [6580] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2020-01-02 09:36:03,706 [6580] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2020-01-02 09:36:08,285 [6580] DEBUG Servicesys_user - 获取实体列表
2020-01-02 09:36:08,287 [6580] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','04050101'))) order by UserSeq
2020-01-02 09:36:08,357 [6580] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','04050101'))) ) tb_temp
2020-01-02 09:36:09,719 [11608] DEBUG Servicesys_user - 获取实体列表
2020-01-02 09:36:09,719 [11608] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040502'))) order by UserSeq
2020-01-02 09:36:09,758 [11608] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040502'))) ) tb_temp
2020-01-02 09:36:10,629 [11456] DEBUG Servicesys_user - 获取实体列表
2020-01-02 09:36:10,630 [11456] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040504'))) order by UserSeq
2020-01-02 09:36:10,663 [11456] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040504'))) ) tb_temp
2020-01-02 09:36:11,568 [8852] DEBUG Servicesys_user - 获取实体列表
2020-01-02 09:36:11,568 [8852] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0402'))) order by UserSeq
2020-01-02 09:36:11,602 [8852] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0402'))) ) tb_temp
2020-01-02 09:36:12,544 [6484] DEBUG Servicesys_user - 获取实体列表
2020-01-02 09:36:12,545 [6484] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040202'))) order by UserSeq
2020-01-02 09:36:12,586 [6484] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040202'))) ) tb_temp
2020-01-02 09:36:13,213 [8852] DEBUG Servicesys_user - 获取实体列表
2020-01-02 09:36:13,213 [8852] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040201'))) order by UserSeq
2020-01-02 09:36:13,254 [8852] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040201'))) ) tb_temp
2020-01-02 09:36:15,449 [6484] DEBUG Servicesys_user - 获取实体列表
2020-01-02 09:36:15,449 [6484] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040602'))) order by UserSeq
2020-01-02 09:36:15,489 [6484] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040602'))) ) tb_temp
2020-01-02 09:36:16,072 [11608] DEBUG Servicesys_user - 获取实体列表
2020-01-02 09:36:16,072 [11608] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','04060101'))) order by UserSeq
2020-01-02 09:36:16,113 [11608] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','04060101'))) ) tb_temp
2020-01-02 09:36:16,920 [11456] DEBUG Servicesys_user - 获取实体列表
2020-01-02 09:36:16,920 [11456] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040602'))) order by UserSeq
2020-01-02 09:36:16,922 [11456] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040602'))) ) tb_temp
2020-01-02 09:36:17,441 [6580] DEBUG Servicesys_user - 获取实体列表
2020-01-02 09:36:17,441 [6580] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040603'))) order by UserSeq
2020-01-02 09:36:17,480 [6580] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040603'))) ) tb_temp
2020-01-02 09:36:18,046 [8852] DEBUG Servicesys_user - 获取实体列表
2020-01-02 09:36:18,046 [8852] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040604'))) order by UserSeq
2020-01-02 09:36:18,078 [8852] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040604'))) ) tb_temp
2020-01-02 09:36:18,736 [6580] DEBUG Servicesys_user - 获取实体列表
2020-01-02 09:36:18,736 [6580] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','04060501'))) order by UserSeq
2020-01-02 09:36:18,767 [6580] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','04060501'))) ) tb_temp
2020-01-02 09:37:04,565 [11456] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/code/Index','/Sys/code')
2020-01-02 09:37:05,712 [6484] DEBUG Servicesys_codeType - 获取动态列表
2020-01-02 09:37:05,713 [6484] DEBUG Sys - select sys_codeType.* from sys_codeType order by Seq,CodeType
2020-01-02 09:37:05,877 [6580] DEBUG Servicesys_code - 获取实体列表
2020-01-02 09:37:05,883 [6580] DEBUG Sys - select top 20 sys_code.* from sys_code order by Seq
2020-01-02 09:37:05,903 [6580] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code ) tb_temp
2020-01-02 09:37:07,535 [11456] DEBUG Servicesys_code - 获取实体列表
2020-01-02 09:37:07,535 [11456] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'PartAttr' order by Seq
2020-01-02 09:37:07,538 [11456] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'PartAttr' ) tb_temp
2020-01-02 09:37:08,838 [3724] DEBUG Servicesys_code - 获取实体列表
2020-01-02 09:37:08,838 [3724] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'KeyProjects' order by Seq
2020-01-02 09:37:08,842 [3724] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'KeyProjects' ) tb_temp
2020-01-02 09:37:09,800 [6484] DEBUG Servicesys_code - 获取实体列表
2020-01-02 09:37:09,800 [6484] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'QualityRequire' order by Seq
2020-01-02 09:37:09,804 [6484] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'QualityRequire' ) tb_temp
2020-01-02 09:37:12,305 [6580] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/user/Index','/Sys/user')
2020-01-02 09:37:12,578 [11608] DEBUG Servicesys_organize - 获取实体列表
2020-01-02 09:37:12,578 [11608] DEBUG Sys - select sys_organize.* from sys_organize
2020-01-02 09:37:12,610 [11456] DEBUG Servicesys_user - 获取实体列表
2020-01-02 09:37:12,611 [11456] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2020-01-02 09:37:12,613 [11456] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2020-01-02 09:37:14,394 [11608] DEBUG Servicesys_user - 获取实体列表
2020-01-02 09:37:14,394 [11608] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040604'))) order by UserSeq
2020-01-02 09:37:14,396 [11608] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040604'))) ) tb_temp
2020-01-02 09:37:15,260 [11456] DEBUG Servicesys_user - 获取实体列表
2020-01-02 09:37:15,261 [11456] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','04060501'))) order by UserSeq
2020-01-02 09:37:15,263 [11456] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','04060501'))) ) tb_temp
2020-01-02 09:37:16,069 [11608] DEBUG Servicesys_user - 获取实体列表
2020-01-02 09:37:16,069 [11608] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0408'))) order by UserSeq
2020-01-02 09:37:16,104 [11608] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0408'))) ) tb_temp
2020-01-02 09:37:16,697 [11456] DEBUG Servicesys_user - 获取实体列表
2020-01-02 09:37:16,698 [11456] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040804'))) order by UserSeq
2020-01-02 09:37:16,730 [11456] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040804'))) ) tb_temp
2020-01-02 09:37:17,315 [3724] DEBUG Servicesys_user - 获取实体列表
2020-01-02 09:37:17,315 [3724] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040803'))) order by UserSeq
2020-01-02 09:37:17,356 [3724] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040803'))) ) tb_temp
2020-01-02 09:37:17,737 [6484] DEBUG Servicesys_user - 获取实体列表
2020-01-02 09:37:17,737 [6484] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040801'))) order by UserSeq
2020-01-02 09:37:17,766 [6484] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040801'))) ) tb_temp
2020-01-02 09:37:18,346 [6580] DEBUG Servicesys_user - 获取实体列表
2020-01-02 09:37:18,346 [6580] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040802'))) order by UserSeq
2020-01-02 09:37:18,384 [6580] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040802'))) ) tb_temp
2020-01-02 09:37:18,731 [3724] DEBUG Servicesys_user - 获取实体列表
2020-01-02 09:37:18,732 [3724] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040804'))) order by UserSeq
2020-01-02 09:37:18,733 [3724] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040804'))) ) tb_temp
2020-01-02 09:37:19,108 [11456] DEBUG Servicesys_user - 获取实体列表
2020-01-02 09:37:19,108 [11456] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0409'))) order by UserSeq
2020-01-02 09:37:19,151 [11456] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0409'))) ) tb_temp
2020-01-02 09:37:19,875 [11608] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/log/Index','/Sys/log')
2020-01-02 09:37:20,629 [6484] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/parameter/Index','/Sys/parameter')
2020-01-02 09:37:21,204 [3724] DEBUG Servicesys_loginHistory - 获取实体列表
2020-01-02 09:37:21,205 [3724] DEBUG Sys - select top 20 
        A.*
     from 
        sys_loginHistory A
     order by A.ID desc
2020-01-02 09:37:21,215 [11608] DEBUG Servicesys_log - 获取实体列表
2020-01-02 09:37:21,216 [11608] DEBUG Sys - select top 20 
        A.*
     from 
        sys_log A
     order by A.ID desc
2020-01-02 09:37:21,226 [3724] DEBUG Sys - select count(*) from ( select 
        A.*
     from 
        sys_loginHistory A
     ) tb_temp
2020-01-02 09:37:21,245 [11608] DEBUG Sys - select count(*) from ( select 
        A.*
     from 
        sys_log A
     ) tb_temp
2020-01-02 09:37:21,606 [11456] DEBUG Servicesys_parameter - 获取实体列表
2020-01-02 09:37:21,607 [11456] DEBUG Sys - select top 20 sys_parameter.* from sys_parameter order by ParamCode
2020-01-02 09:37:21,625 [11456] DEBUG Sys - select count(*) from ( select sys_parameter.* from sys_parameter ) tb_temp
2020-01-02 09:37:23,701 [11456] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/user/Index','/Sys/user')
2020-01-02 09:37:23,974 [11608] DEBUG Servicesys_user - 获取实体列表
2020-01-02 09:37:23,974 [11608] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2020-01-02 09:37:23,980 [11608] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2020-01-02 09:37:24,000 [6580] DEBUG Servicesys_organize - 获取实体列表
2020-01-02 09:37:24,000 [6580] DEBUG Sys - select sys_organize.* from sys_organize
2020-01-02 09:37:38,563 [6580] DEBUG Servicesys_userSetting - 获取实体列表
2020-01-02 09:37:38,564 [6580] DEBUG Sys - select sys_userSetting.* from sys_userSetting where  UserCode =  'scy'
2020-01-02 09:37:50,872 [6580] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode and B.UserCode = 'lhs'
2020-01-02 09:46:16,785 [6484] DEBUG Servicesys_user - 获取实体对象
2020-01-02 09:46:16,790 [6484] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  '123'and IsEnable =  'True'
2020-01-02 09:46:19,734 [9432] DEBUG Servicesys_user - 获取实体对象
2020-01-02 09:46:19,734 [9432] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  '1234'and IsEnable =  'True'
2020-01-02 09:46:19,735 [9432] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'admin' 
2020-01-02 09:46:19,740 [9432] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('admin','管理员','WIN-3S9VPNGGB1T','localhost','上海市','2020-01-02 09:46:19')
2020-01-02 09:46:19,742 [9432] DEBUG Servicemms_project - 获取实体对象
2020-01-02 09:46:19,746 [9432] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2020-01-02 09:46:19,773 [12204] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2020-01-02 09:46:20,087 [12452] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-02 09:46:29,272 [6580] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/report/balanceaccount')
2020-01-02 09:46:29,275 [6580] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-02 09:46:29,275 [6580] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-02 09:46:29,276 [6580] DEBUG Servicemms_buildPart - 获取动态列表
2020-01-02 09:46:29,276 [6580] DEBUG Mms - select BuildPartCode as value,BuildPartName as text from mms_buildPart where  ProjectCode =  '201306030001'
2020-01-02 09:46:29,570 [9432] DEBUG Mms - 
Select PickUnitName
From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030001'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030001'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'
) as t
Where PickUnitName<>'' and PickUnitName<>'其他' and PickUnitName<>'租赁进场'
group by PickUnitName
                
2020-01-02 09:46:29,571 [9432] DEBUG Mms - 
Select MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else 0 end),0) as ReceiveMoney --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Money else 0 end),0) as StockSelfMoney --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Money else 0 end),0) as OwnerSupplyMoney --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Money else 0 end),0) as CallInMoney --调入
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Money else 0 end),0) as ReceiveOtherMoney --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else 0 end),0) as ReceiveNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Num else 0 end),0) as StockSelfNum --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Num else 0 end),0) as OwnerSupplyNum --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Num else 0 end),0) as CallInNum --调入
	,ISNULL(Sum(CASE WHEN SupplyType='租赁进场' then Num else 0 end),0) as ReceiveRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Num else 0 end),0) as ReceiveOtherNum --其他

    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Money else 0 end),0) as SendMoney --合计
    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Num else 0 end),0) as SendNum --合计
     ,ISNULL(Sum(CASE WHEN PickUnitName='北京士兴钢结构有限公司' then Num else 0 end),0) as PickUnitNum0 ,ISNULL(Sum(CASE WHEN PickUnitName='北京士兴钢结构有限公司' then Money else 0 end),0) as PickUnitMoney0 ,ISNULL(Sum(CASE WHEN PickUnitName='河北天强建筑工程有限公司' then Num else 0 end),0) as PickUnitNum1 ,ISNULL(Sum(CASE WHEN PickUnitName='河北天强建筑工程有限公司' then Money else 0 end),0) as PickUnitMoney1                                                             --领料人生成的列
    ,ISNULL(Sum(CASE WHEN PickUnitName='租赁进场' then Num else 0 end),0) as SendRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Money else 0 end),0) as SendOtherMoney --其他
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Num else 0 end),0) as SendOtherNum --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else -Num end),0) as TotalNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else -Money end),0) as TotalMoney --合计

From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030001'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030001'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'
) as t
group by MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit

2020-01-02 09:46:29,575 [9432] DEBUG Mms - 
Select mms_warehouseStockHistory.MaterialCode,sum(Num) As InitNum,sum(UnitPrice*Num) As InitMoney
From mms_warehouseStockHistory
Left join mms_warehouse on mms_warehouse.warehouseCode=mms_warehouseStockHistory.warehouseCode
Left join mms_material on mms_material.MaterialCode=mms_warehouseStockHistory.MaterialCode
Where 1=1  And  mms_warehouse.ProjectCode='201306030001'
group by mms_warehouseStockHistory.MaterialCode

2020-01-02 09:46:58,544 [12204] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/report/receivesummary')
2020-01-02 09:46:59,653 [6712] DEBUG Mms - 
Select T.*
From
( 
    --收料单
    Select mms_receive.BillNo As SrcBillNo,'receive' As SrcBillType,mms_receive.ContractCode As ContractCode,
	    mms_receive.SupplierCode,mms_receive.OriginalNum,mms_receive.ReceiveDate As TakeDate,
	    mms_receiveDetail.MaterialCode,mms_receiveDetail.Unit,mms_receiveDetail.UnitPrice,
	    mms_receiveDetail.Num,mms_receiveDetail.Money,mms_receiveDetail.Remark,mms_merchants.MerchantsName AS SupplierName,
        '' as name,(mms_receive.BillNo+'receive'+mms_receiveDetail.MaterialCode) as id,mms_material.MaterialName,mms_material.Model
    From mms_receiveDetail
    Left join mms_receive ON mms_receiveDetail.BillNo=mms_receive.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_receive.SupplierCode
    left join mms_material on mms_material.MaterialCode=mms_receiveDetail.MaterialCode
    Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

    UNION

    --直入直出
    Select mms_direct.BillNo As SrcBillNo,'direct' As SrcBillType,mms_direct.ContractCode As ContractCode,
	    mms_direct.SupplierCode,mms_direct.OriginalNum,mms_direct.ArriveDate As TakeDate,
	    mms_directDetail.MaterialCode,mms_directDetail.Unit,mms_directDetail.UnitPrice,
	    mms_directDetail.Num,mms_directDetail.Money,mms_directDetail.Remark,mms_merchants.MerchantsName AS SupplierName,
        '' as name,(mms_direct.BillNo+'direct'+mms_directDetail.MaterialCode) as id,mms_material.MaterialName,mms_material.Model
    From mms_directDetail
    Left join mms_direct ON mms_directDetail.BillNo=mms_direct.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_direct.SupplierCode
    left join mms_material on mms_material.MaterialCode=mms_directDetail.MaterialCode
    Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

    UNION

    --退货
    Select mms_return.BillNo As SrcBillNo,'return' As SrcBillType,mms_return.ContractCode As ContractCode,
	    mms_return.SupplierCode,'' AS OriginalNum,mms_return.ReturnDate As TakeDate,
	    mms_returnDetail.MaterialCode,mms_returnDetail.Unit,mms_returnDetail.UnitPrice,
	    -mms_returnDetail.Num,-mms_returnDetail.Money,mms_returnDetail.Remark,mms_merchants.MerchantsName AS SupplierName,
        '' as name,(mms_return.BillNo+'return'+mms_returnDetail.MaterialCode) as id,mms_material.MaterialName,mms_material.Model
    From mms_returnDetail
    Left join mms_return ON mms_returnDetail.BillNo=mms_return.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_return.SupplierCode
    left join mms_material on mms_material.MaterialCode=mms_returnDetail.MaterialCode
    Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

    UNION

    --租赁进场
    Select mms_rentIn.BillNo As SrcBillNo,'rentin' As SrcBillType,mms_rentIn.ContractCode As ContractCode,
	    mms_rentIn.SupplierCode,'' as OriginalNum,mms_rentIn.RentInDate As TakeDate,
	    mms_rentInDetail.MaterialCode,mms_rentInDetail.Unit,mms_rentInDetail.UnitPrice,
	    mms_rentInDetail.Num,'0' as Money,mms_rentInDetail.Remark,mms_merchants.MerchantsName AS SupplierName,
        '' as name,(mms_rentIn.BillNo+'rentIn'+mms_rentInDetail.MaterialCode) as id,mms_material.MaterialName,mms_material.Model
    From mms_rentInDetail
    Left join mms_rentIn ON mms_rentInDetail.BillNo=mms_rentIn.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_rentIn.SupplierCode
    left join mms_material on mms_material.MaterialCode=mms_rentInDetail.MaterialCode
    Where mms_rentIn.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'
) as T
Where 1=1 
                
2020-01-02 09:47:10,119 [12204] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/report/sendsummary')
2020-01-02 09:47:10,129 [12204] DEBUG Servicemms_buildPart - 获取动态列表
2020-01-02 09:47:10,129 [12204] DEBUG Mms - select BuildPartCode as value,BuildPartName as text from mms_buildPart where  ProjectCode =  '201306030001'
2020-01-02 09:47:11,379 [6580] DEBUG Mms - 
Select T.*
From
( 
	--发料单
    Select mms_send.BillNo As SrcBillNo,'send' As SrcBillType,mms_send.SendDate As TakeDate,
		mms_send.PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_sendDetail.Unit,mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,
		mms_sendDetail.Remark,'' as name,(mms_send.BillNo+'send'+mms_sendDetail.MaterialCode) as id
    From mms_sendDetail
    Left join mms_send ON mms_sendDetail.BillNo=mms_send.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_send.PickUnit
    left join mms_material on mms_material.MaterialCode=mms_sendDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_send.BuildPartCode
    Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

    UNION

    --直入直出
    Select mms_direct.BillNo As SrcBillNo,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
		mms_direct.PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_directDetail.Unit,mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,
		mms_directDetail.Remark,'' as name,(mms_direct.BillNo+'direct'+mms_directDetail.MaterialCode) as id
    From mms_directDetail
    Left join mms_direct ON mms_directDetail.BillNo=mms_direct.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_direct.PickUnit
    left join mms_material on mms_material.MaterialCode=mms_directDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_direct.BuildPartCode
    Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

    UNION

    --退库
     Select mms_refund.BillNo As SrcBillNo,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
		mms_refund.RefundUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,NULL AS BuildPartName,
	    mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_refundDetail.Unit,mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,
		mms_refundDetail.Remark,'' as name,(mms_refund.BillNo+'refund'+mms_refundDetail.MaterialCode) as id
    From mms_refundDetail
    Left join mms_refund ON mms_refundDetail.BillNo=mms_refund.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_refund.RefundUnit
    left join mms_material on mms_material.MaterialCode=mms_refundDetail.MaterialCode
    Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

    UNION

    --租赁进场
    Select mms_rentin.BillNo As SrcBillNo,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
		mms_rentinDetail.UseUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_rentinDetail.Unit,mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,
		mms_rentinDetail.Remark,'' as name,(mms_rentin.BillNo+'rentin'+mms_rentinDetail.MaterialCode) as id
    From mms_rentinDetail
    Left join mms_rentin ON mms_rentinDetail.BillNo=mms_rentin.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
    left join mms_material on mms_material.MaterialCode=mms_rentinDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_rentin.BuildPartCode
    Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

    UNION

	--报损
	Select mms_lossReport.BillNo As SrcBillNo,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
		'其他' as PickUnit,'其他' as PickUnitName,NULL AS BuildPartName,
	    mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_lossReportDetail.Unit,mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,
		mms_lossReportDetail.Remark,'' as name,(mms_lossReport.BillNo+'lossReport'+mms_lossReportDetail.MaterialCode) as id
    From mms_lossReportDetail
    Left join mms_lossReport ON mms_lossReportDetail.BillNo=mms_lossReport.BillNo
    left join mms_material on mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
    Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'

    UNION

	--调拨
	Select mms_transfer.BillNo As SrcBillNo,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
		mms_transfer.ReceiveUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,NULL AS BuildPartName,
	    mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_transferDetail.Unit,mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,
		mms_transferDetail.Remark,'' as name,(mms_transfer.BillNo+'transfer'+mms_transferDetail.MaterialCode) as id
    From mms_transferDetail
    Left join mms_transfer ON mms_transferDetail.BillNo=mms_transfer.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
    left join mms_material on mms_material.MaterialCode=mms_transferDetail.MaterialCode
    Where mms_transfer.ApproveState='passed'  And  mms_transfer.ProjectCode='201306030001'

) as T
Where 1=1 

                
2020-01-02 09:49:49,971 [6712] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Psi/Supplier/Index','/Psi/Supplier')
2020-01-02 09:51:52,075 [12772] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/report/sendsummary')
2020-01-02 09:51:52,078 [12772] DEBUG Servicemms_buildPart - 获取动态列表
2020-01-02 09:51:52,078 [12772] DEBUG Mms - select BuildPartCode as value,BuildPartName as text from mms_buildPart where  ProjectCode =  '201306030001'
2020-01-02 09:51:53,335 [12204] DEBUG Mms - 
Select T.*
From
( 
	--发料单
    Select mms_send.BillNo As SrcBillNo,'send' As SrcBillType,mms_send.SendDate As TakeDate,
		mms_send.PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_sendDetail.Unit,mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,
		mms_sendDetail.Remark,'' as name,(mms_send.BillNo+'send'+mms_sendDetail.MaterialCode) as id
    From mms_sendDetail
    Left join mms_send ON mms_sendDetail.BillNo=mms_send.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_send.PickUnit
    left join mms_material on mms_material.MaterialCode=mms_sendDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_send.BuildPartCode
    Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

    UNION

    --直入直出
    Select mms_direct.BillNo As SrcBillNo,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
		mms_direct.PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_directDetail.Unit,mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,
		mms_directDetail.Remark,'' as name,(mms_direct.BillNo+'direct'+mms_directDetail.MaterialCode) as id
    From mms_directDetail
    Left join mms_direct ON mms_directDetail.BillNo=mms_direct.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_direct.PickUnit
    left join mms_material on mms_material.MaterialCode=mms_directDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_direct.BuildPartCode
    Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

    UNION

    --退库
     Select mms_refund.BillNo As SrcBillNo,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
		mms_refund.RefundUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,NULL AS BuildPartName,
	    mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_refundDetail.Unit,mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,
		mms_refundDetail.Remark,'' as name,(mms_refund.BillNo+'refund'+mms_refundDetail.MaterialCode) as id
    From mms_refundDetail
    Left join mms_refund ON mms_refundDetail.BillNo=mms_refund.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_refund.RefundUnit
    left join mms_material on mms_material.MaterialCode=mms_refundDetail.MaterialCode
    Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

    UNION

    --租赁进场
    Select mms_rentin.BillNo As SrcBillNo,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
		mms_rentinDetail.UseUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_rentinDetail.Unit,mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,
		mms_rentinDetail.Remark,'' as name,(mms_rentin.BillNo+'rentin'+mms_rentinDetail.MaterialCode) as id
    From mms_rentinDetail
    Left join mms_rentin ON mms_rentinDetail.BillNo=mms_rentin.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
    left join mms_material on mms_material.MaterialCode=mms_rentinDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_rentin.BuildPartCode
    Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

    UNION

	--报损
	Select mms_lossReport.BillNo As SrcBillNo,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
		'其他' as PickUnit,'其他' as PickUnitName,NULL AS BuildPartName,
	    mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_lossReportDetail.Unit,mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,
		mms_lossReportDetail.Remark,'' as name,(mms_lossReport.BillNo+'lossReport'+mms_lossReportDetail.MaterialCode) as id
    From mms_lossReportDetail
    Left join mms_lossReport ON mms_lossReportDetail.BillNo=mms_lossReport.BillNo
    left join mms_material on mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
    Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'

    UNION

	--调拨
	Select mms_transfer.BillNo As SrcBillNo,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
		mms_transfer.ReceiveUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,NULL AS BuildPartName,
	    mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_transferDetail.Unit,mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,
		mms_transferDetail.Remark,'' as name,(mms_transfer.BillNo+'transfer'+mms_transferDetail.MaterialCode) as id
    From mms_transferDetail
    Left join mms_transfer ON mms_transferDetail.BillNo=mms_transfer.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
    left join mms_material on mms_material.MaterialCode=mms_transferDetail.MaterialCode
    Where mms_transfer.ApproveState='passed'  And  mms_transfer.ProjectCode='201306030001'

) as T
Where 1=1 

                
2020-01-02 09:52:00,080 [12772] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/report/sendsummary')
2020-01-02 09:52:00,084 [12772] DEBUG Servicemms_buildPart - 获取动态列表
2020-01-02 09:52:00,084 [12772] DEBUG Mms - select BuildPartCode as value,BuildPartName as text from mms_buildPart where  ProjectCode =  '201306030001'
2020-01-02 09:52:01,481 [6712] DEBUG Mms - 
Select T.*
From
( 
	--发料单
    Select mms_send.BillNo As SrcBillNo,'send' As SrcBillType,mms_send.SendDate As TakeDate,
		mms_send.PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_sendDetail.Unit,mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,
		mms_sendDetail.Remark,'' as name,(mms_send.BillNo+'send'+mms_sendDetail.MaterialCode) as id
    From mms_sendDetail
    Left join mms_send ON mms_sendDetail.BillNo=mms_send.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_send.PickUnit
    left join mms_material on mms_material.MaterialCode=mms_sendDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_send.BuildPartCode
    Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

    UNION

    --直入直出
    Select mms_direct.BillNo As SrcBillNo,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
		mms_direct.PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_directDetail.Unit,mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,
		mms_directDetail.Remark,'' as name,(mms_direct.BillNo+'direct'+mms_directDetail.MaterialCode) as id
    From mms_directDetail
    Left join mms_direct ON mms_directDetail.BillNo=mms_direct.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_direct.PickUnit
    left join mms_material on mms_material.MaterialCode=mms_directDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_direct.BuildPartCode
    Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

    UNION

    --退库
     Select mms_refund.BillNo As SrcBillNo,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
		mms_refund.RefundUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,NULL AS BuildPartName,
	    mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_refundDetail.Unit,mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,
		mms_refundDetail.Remark,'' as name,(mms_refund.BillNo+'refund'+mms_refundDetail.MaterialCode) as id
    From mms_refundDetail
    Left join mms_refund ON mms_refundDetail.BillNo=mms_refund.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_refund.RefundUnit
    left join mms_material on mms_material.MaterialCode=mms_refundDetail.MaterialCode
    Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

    UNION

    --租赁进场
    Select mms_rentin.BillNo As SrcBillNo,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
		mms_rentinDetail.UseUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_rentinDetail.Unit,mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,
		mms_rentinDetail.Remark,'' as name,(mms_rentin.BillNo+'rentin'+mms_rentinDetail.MaterialCode) as id
    From mms_rentinDetail
    Left join mms_rentin ON mms_rentinDetail.BillNo=mms_rentin.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
    left join mms_material on mms_material.MaterialCode=mms_rentinDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_rentin.BuildPartCode
    Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

    UNION

	--报损
	Select mms_lossReport.BillNo As SrcBillNo,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
		'其他' as PickUnit,'其他' as PickUnitName,NULL AS BuildPartName,
	    mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_lossReportDetail.Unit,mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,
		mms_lossReportDetail.Remark,'' as name,(mms_lossReport.BillNo+'lossReport'+mms_lossReportDetail.MaterialCode) as id
    From mms_lossReportDetail
    Left join mms_lossReport ON mms_lossReportDetail.BillNo=mms_lossReport.BillNo
    left join mms_material on mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
    Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'

    UNION

	--调拨
	Select mms_transfer.BillNo As SrcBillNo,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
		mms_transfer.ReceiveUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,NULL AS BuildPartName,
	    mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_transferDetail.Unit,mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,
		mms_transferDetail.Remark,'' as name,(mms_transfer.BillNo+'transfer'+mms_transferDetail.MaterialCode) as id
    From mms_transferDetail
    Left join mms_transfer ON mms_transferDetail.BillNo=mms_transfer.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
    left join mms_material on mms_material.MaterialCode=mms_transferDetail.MaterialCode
    Where mms_transfer.ApproveState='passed'  And  mms_transfer.ProjectCode='201306030001'

) as T
Where 1=1 

                
2020-01-02 09:52:09,672 [6580] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/report/sendsummary')
2020-01-02 09:52:09,674 [6580] DEBUG Servicemms_buildPart - 获取动态列表
2020-01-02 09:52:09,675 [6580] DEBUG Mms - select BuildPartCode as value,BuildPartName as text from mms_buildPart where  ProjectCode =  '201306030001'
2020-01-02 09:52:11,074 [6484] DEBUG Mms - 
Select T.*
From
( 
	--发料单
    Select mms_send.BillNo As SrcBillNo,'send' As SrcBillType,mms_send.SendDate As TakeDate,
		mms_send.PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_sendDetail.Unit,mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,
		mms_sendDetail.Remark,'' as name,(mms_send.BillNo+'send'+mms_sendDetail.MaterialCode) as id
    From mms_sendDetail
    Left join mms_send ON mms_sendDetail.BillNo=mms_send.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_send.PickUnit
    left join mms_material on mms_material.MaterialCode=mms_sendDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_send.BuildPartCode
    Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

    UNION

    --直入直出
    Select mms_direct.BillNo As SrcBillNo,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
		mms_direct.PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_directDetail.Unit,mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,
		mms_directDetail.Remark,'' as name,(mms_direct.BillNo+'direct'+mms_directDetail.MaterialCode) as id
    From mms_directDetail
    Left join mms_direct ON mms_directDetail.BillNo=mms_direct.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_direct.PickUnit
    left join mms_material on mms_material.MaterialCode=mms_directDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_direct.BuildPartCode
    Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

    UNION

    --退库
     Select mms_refund.BillNo As SrcBillNo,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
		mms_refund.RefundUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,NULL AS BuildPartName,
	    mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_refundDetail.Unit,mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,
		mms_refundDetail.Remark,'' as name,(mms_refund.BillNo+'refund'+mms_refundDetail.MaterialCode) as id
    From mms_refundDetail
    Left join mms_refund ON mms_refundDetail.BillNo=mms_refund.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_refund.RefundUnit
    left join mms_material on mms_material.MaterialCode=mms_refundDetail.MaterialCode
    Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

    UNION

    --租赁进场
    Select mms_rentin.BillNo As SrcBillNo,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
		mms_rentinDetail.UseUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_rentinDetail.Unit,mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,
		mms_rentinDetail.Remark,'' as name,(mms_rentin.BillNo+'rentin'+mms_rentinDetail.MaterialCode) as id
    From mms_rentinDetail
    Left join mms_rentin ON mms_rentinDetail.BillNo=mms_rentin.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
    left join mms_material on mms_material.MaterialCode=mms_rentinDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_rentin.BuildPartCode
    Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

    UNION

	--报损
	Select mms_lossReport.BillNo As SrcBillNo,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
		'其他' as PickUnit,'其他' as PickUnitName,NULL AS BuildPartName,
	    mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_lossReportDetail.Unit,mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,
		mms_lossReportDetail.Remark,'' as name,(mms_lossReport.BillNo+'lossReport'+mms_lossReportDetail.MaterialCode) as id
    From mms_lossReportDetail
    Left join mms_lossReport ON mms_lossReportDetail.BillNo=mms_lossReport.BillNo
    left join mms_material on mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
    Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'

    UNION

	--调拨
	Select mms_transfer.BillNo As SrcBillNo,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
		mms_transfer.ReceiveUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,NULL AS BuildPartName,
	    mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_transferDetail.Unit,mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,
		mms_transferDetail.Remark,'' as name,(mms_transfer.BillNo+'transfer'+mms_transferDetail.MaterialCode) as id
    From mms_transferDetail
    Left join mms_transfer ON mms_transferDetail.BillNo=mms_transfer.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
    left join mms_material on mms_material.MaterialCode=mms_transferDetail.MaterialCode
    Where mms_transfer.ApproveState='passed'  And  mms_transfer.ProjectCode='201306030001'

) as T
Where 1=1 

                
2020-01-02 10:06:24,746 [6484] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/report/sendsummary')
2020-01-02 10:06:24,749 [6484] DEBUG Servicemms_buildPart - 获取动态列表
2020-01-02 10:06:24,753 [6484] DEBUG Mms - select BuildPartCode as value,BuildPartName as text from mms_buildPart where  ProjectCode =  '201306030001'
2020-01-02 10:06:26,269 [1872] DEBUG Mms - 
Select T.*
From
( 
	--发料单
    Select mms_send.BillNo As SrcBillNo,'send' As SrcBillType,mms_send.SendDate As TakeDate,
		mms_send.PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_sendDetail.Unit,mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,
		mms_sendDetail.Remark,'' as name,(mms_send.BillNo+'send'+mms_sendDetail.MaterialCode) as id
    From mms_sendDetail
    Left join mms_send ON mms_sendDetail.BillNo=mms_send.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_send.PickUnit
    left join mms_material on mms_material.MaterialCode=mms_sendDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_send.BuildPartCode
    Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

    UNION

    --直入直出
    Select mms_direct.BillNo As SrcBillNo,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
		mms_direct.PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_directDetail.Unit,mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,
		mms_directDetail.Remark,'' as name,(mms_direct.BillNo+'direct'+mms_directDetail.MaterialCode) as id
    From mms_directDetail
    Left join mms_direct ON mms_directDetail.BillNo=mms_direct.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_direct.PickUnit
    left join mms_material on mms_material.MaterialCode=mms_directDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_direct.BuildPartCode
    Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

    UNION

    --退库
     Select mms_refund.BillNo As SrcBillNo,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
		mms_refund.RefundUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,NULL AS BuildPartName,
	    mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_refundDetail.Unit,mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,
		mms_refundDetail.Remark,'' as name,(mms_refund.BillNo+'refund'+mms_refundDetail.MaterialCode) as id
    From mms_refundDetail
    Left join mms_refund ON mms_refundDetail.BillNo=mms_refund.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_refund.RefundUnit
    left join mms_material on mms_material.MaterialCode=mms_refundDetail.MaterialCode
    Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

    UNION

    --租赁进场
    Select mms_rentin.BillNo As SrcBillNo,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
		mms_rentinDetail.UseUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,mms_buildPart.BuildPartName,
	    mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_rentinDetail.Unit,mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,
		mms_rentinDetail.Remark,'' as name,(mms_rentin.BillNo+'rentin'+mms_rentinDetail.MaterialCode) as id
    From mms_rentinDetail
    Left join mms_rentin ON mms_rentinDetail.BillNo=mms_rentin.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
    left join mms_material on mms_material.MaterialCode=mms_rentinDetail.MaterialCode
	left join mms_buildPart on mms_buildPart.BuildPartCode=mms_rentin.BuildPartCode
    Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

    UNION

	--报损
	Select mms_lossReport.BillNo As SrcBillNo,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
		'其他' as PickUnit,'其他' as PickUnitName,NULL AS BuildPartName,
	    mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_lossReportDetail.Unit,mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,
		mms_lossReportDetail.Remark,'' as name,(mms_lossReport.BillNo+'lossReport'+mms_lossReportDetail.MaterialCode) as id
    From mms_lossReportDetail
    Left join mms_lossReport ON mms_lossReportDetail.BillNo=mms_lossReport.BillNo
    left join mms_material on mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
    Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'

    UNION

	--调拨
	Select mms_transfer.BillNo As SrcBillNo,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
		mms_transfer.ReceiveUnit as PickUnit,mms_merchants.MerchantsName as PickUnitName,NULL AS BuildPartName,
	    mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,
		mms_transferDetail.Unit,mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,
		mms_transferDetail.Remark,'' as name,(mms_transfer.BillNo+'transfer'+mms_transferDetail.MaterialCode) as id
    From mms_transferDetail
    Left join mms_transfer ON mms_transferDetail.BillNo=mms_transfer.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
    left join mms_material on mms_material.MaterialCode=mms_transferDetail.MaterialCode
    Where mms_transfer.ApproveState='passed'  And  mms_transfer.ProjectCode='201306030001'

) as T
Where 1=1 

                
2020-01-02 10:06:36,021 [11608] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2020-01-02 10:06:39,043 [12452] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-02 10:07:00,166 [1872] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2020-01-02 10:07:00,646 [6484] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-02 10:07:01,609 [11608] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/report/receivesummary')
2020-01-02 10:07:03,232 [9432] DEBUG Mms - 
Select T.*
From
( 
    --收料单
    Select mms_receive.BillNo As SrcBillNo,'receive' As SrcBillType,mms_receive.ContractCode As ContractCode,
	    mms_receive.SupplierCode,mms_receive.OriginalNum,mms_receive.ReceiveDate As TakeDate,
	    mms_receiveDetail.MaterialCode,mms_receiveDetail.Unit,mms_receiveDetail.UnitPrice,
	    mms_receiveDetail.Num,mms_receiveDetail.Money,mms_receiveDetail.Remark,mms_merchants.MerchantsName AS SupplierName,
        '' as name,(mms_receive.BillNo+'receive'+mms_receiveDetail.MaterialCode) as id,mms_material.MaterialName,mms_material.Model
    From mms_receiveDetail
    Left join mms_receive ON mms_receiveDetail.BillNo=mms_receive.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_receive.SupplierCode
    left join mms_material on mms_material.MaterialCode=mms_receiveDetail.MaterialCode
    Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

    UNION

    --直入直出
    Select mms_direct.BillNo As SrcBillNo,'direct' As SrcBillType,mms_direct.ContractCode As ContractCode,
	    mms_direct.SupplierCode,mms_direct.OriginalNum,mms_direct.ArriveDate As TakeDate,
	    mms_directDetail.MaterialCode,mms_directDetail.Unit,mms_directDetail.UnitPrice,
	    mms_directDetail.Num,mms_directDetail.Money,mms_directDetail.Remark,mms_merchants.MerchantsName AS SupplierName,
        '' as name,(mms_direct.BillNo+'direct'+mms_directDetail.MaterialCode) as id,mms_material.MaterialName,mms_material.Model
    From mms_directDetail
    Left join mms_direct ON mms_directDetail.BillNo=mms_direct.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_direct.SupplierCode
    left join mms_material on mms_material.MaterialCode=mms_directDetail.MaterialCode
    Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

    UNION

    --退货
    Select mms_return.BillNo As SrcBillNo,'return' As SrcBillType,mms_return.ContractCode As ContractCode,
	    mms_return.SupplierCode,'' AS OriginalNum,mms_return.ReturnDate As TakeDate,
	    mms_returnDetail.MaterialCode,mms_returnDetail.Unit,mms_returnDetail.UnitPrice,
	    -mms_returnDetail.Num,-mms_returnDetail.Money,mms_returnDetail.Remark,mms_merchants.MerchantsName AS SupplierName,
        '' as name,(mms_return.BillNo+'return'+mms_returnDetail.MaterialCode) as id,mms_material.MaterialName,mms_material.Model
    From mms_returnDetail
    Left join mms_return ON mms_returnDetail.BillNo=mms_return.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_return.SupplierCode
    left join mms_material on mms_material.MaterialCode=mms_returnDetail.MaterialCode
    Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

    UNION

    --租赁进场
    Select mms_rentIn.BillNo As SrcBillNo,'rentin' As SrcBillType,mms_rentIn.ContractCode As ContractCode,
	    mms_rentIn.SupplierCode,'' as OriginalNum,mms_rentIn.RentInDate As TakeDate,
	    mms_rentInDetail.MaterialCode,mms_rentInDetail.Unit,mms_rentInDetail.UnitPrice,
	    mms_rentInDetail.Num,'0' as Money,mms_rentInDetail.Remark,mms_merchants.MerchantsName AS SupplierName,
        '' as name,(mms_rentIn.BillNo+'rentIn'+mms_rentInDetail.MaterialCode) as id,mms_material.MaterialName,mms_material.Model
    From mms_rentInDetail
    Left join mms_rentIn ON mms_rentInDetail.BillNo=mms_rentIn.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_rentIn.SupplierCode
    left join mms_material on mms_material.MaterialCode=mms_rentInDetail.MaterialCode
    Where mms_rentIn.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'
) as T
Where 1=1 
                
2020-01-02 10:07:10,010 [12772] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2020-01-02 10:07:12,542 [12204] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-02 10:07:23,584 [1872] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/report/receivesummary')
2020-01-02 10:07:28,359 [12204] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2020-01-02 10:07:29,274 [6712] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-02 10:07:30,307 [6580] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/report/receivesummary')
2020-01-02 10:07:32,191 [12452] DEBUG Mms - 
Select T.*
From
( 
    --收料单
    Select mms_receive.BillNo As SrcBillNo,'receive' As SrcBillType,mms_receive.ContractCode As ContractCode,
	    mms_receive.SupplierCode,mms_receive.OriginalNum,mms_receive.ReceiveDate As TakeDate,
	    mms_receiveDetail.MaterialCode,mms_receiveDetail.Unit,mms_receiveDetail.UnitPrice,
	    mms_receiveDetail.Num,mms_receiveDetail.Money,mms_receiveDetail.Remark,mms_merchants.MerchantsName AS SupplierName,
        '' as name,(mms_receive.BillNo+'receive'+mms_receiveDetail.MaterialCode) as id,mms_material.MaterialName,mms_material.Model
    From mms_receiveDetail
    Left join mms_receive ON mms_receiveDetail.BillNo=mms_receive.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_receive.SupplierCode
    left join mms_material on mms_material.MaterialCode=mms_receiveDetail.MaterialCode
    Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

    UNION

    --直入直出
    Select mms_direct.BillNo As SrcBillNo,'direct' As SrcBillType,mms_direct.ContractCode As ContractCode,
	    mms_direct.SupplierCode,mms_direct.OriginalNum,mms_direct.ArriveDate As TakeDate,
	    mms_directDetail.MaterialCode,mms_directDetail.Unit,mms_directDetail.UnitPrice,
	    mms_directDetail.Num,mms_directDetail.Money,mms_directDetail.Remark,mms_merchants.MerchantsName AS SupplierName,
        '' as name,(mms_direct.BillNo+'direct'+mms_directDetail.MaterialCode) as id,mms_material.MaterialName,mms_material.Model
    From mms_directDetail
    Left join mms_direct ON mms_directDetail.BillNo=mms_direct.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_direct.SupplierCode
    left join mms_material on mms_material.MaterialCode=mms_directDetail.MaterialCode
    Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

    UNION

    --退货
    Select mms_return.BillNo As SrcBillNo,'return' As SrcBillType,mms_return.ContractCode As ContractCode,
	    mms_return.SupplierCode,'' AS OriginalNum,mms_return.ReturnDate As TakeDate,
	    mms_returnDetail.MaterialCode,mms_returnDetail.Unit,mms_returnDetail.UnitPrice,
	    -mms_returnDetail.Num,-mms_returnDetail.Money,mms_returnDetail.Remark,mms_merchants.MerchantsName AS SupplierName,
        '' as name,(mms_return.BillNo+'return'+mms_returnDetail.MaterialCode) as id,mms_material.MaterialName,mms_material.Model
    From mms_returnDetail
    Left join mms_return ON mms_returnDetail.BillNo=mms_return.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_return.SupplierCode
    left join mms_material on mms_material.MaterialCode=mms_returnDetail.MaterialCode
    Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

    UNION

    --租赁进场
    Select mms_rentIn.BillNo As SrcBillNo,'rentin' As SrcBillType,mms_rentIn.ContractCode As ContractCode,
	    mms_rentIn.SupplierCode,'' as OriginalNum,mms_rentIn.RentInDate As TakeDate,
	    mms_rentInDetail.MaterialCode,mms_rentInDetail.Unit,mms_rentInDetail.UnitPrice,
	    mms_rentInDetail.Num,'0' as Money,mms_rentInDetail.Remark,mms_merchants.MerchantsName AS SupplierName,
        '' as name,(mms_rentIn.BillNo+'rentIn'+mms_rentInDetail.MaterialCode) as id,mms_material.MaterialName,mms_material.Model
    From mms_rentInDetail
    Left join mms_rentIn ON mms_rentInDetail.BillNo=mms_rentIn.BillNo
    left join mms_merchants on mms_merchants.MerchantsCode=mms_rentIn.SupplierCode
    left join mms_material on mms_material.MaterialCode=mms_rentInDetail.MaterialCode
    Where mms_rentIn.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'
) as T
Where 1=1 
                
2020-01-02 10:13:42,945 [6712] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/direct/Index','/Mms/direct')
2020-01-02 10:13:42,947 [6712] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-02 10:13:42,969 [6712] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-02 10:13:42,971 [6712] DEBUG Servicesys_code - 获取动态列表
2020-01-02 10:13:42,971 [6712] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-02 10:13:43,756 [9432] DEBUG Servicemms_direct - 获取动态列表
2020-01-02 10:13:43,756 [9432] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName,D.MerchantsName as SupplierName,E.MerchantsName as PickUnitName
     from 
        mms_direct A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_merchants     D on D.MerchantsCode    = A.SupplierCode
        left join mms_merchants     E on E.MerchantsCode    = A.PickUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-02 10:13:43,760 [9432] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName,D.MerchantsName as SupplierName,E.MerchantsName as PickUnitName
     from 
        mms_direct A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_merchants     D on D.MerchantsCode    = A.SupplierCode
        left join mms_merchants     E on E.MerchantsCode    = A.PickUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-02 10:13:45,480 [12772] DEBUG Servicemms_direct - 获取新主键
2020-01-02 10:13:45,480 [12772] DEBUG Mms - select isnull(max(BillNo),0) from mms_direct
2020-01-02 10:13:45,527 [12452] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/direct/edit')
2020-01-02 10:13:45,540 [12452] DEBUG Servicemms_direct - 获取实体对象
2020-01-02 10:13:45,541 [12452] DEBUG Mms - select mms_direct.* from mms_direct where  BillNo =  '202001020001'
2020-01-02 10:13:45,544 [12452] DEBUG Servicemms_direct - 获取上一条下一条数据
2020-01-02 10:13:45,547 [12452] DEBUG Servicemms_direct - 获取字段
2020-01-02 10:13:45,547 [12452] DEBUG Mms - select top 1 BillNo from mms_direct where  ProjectCode =  '201306030001' order by BillNo
2020-01-02 10:13:45,557 [12452] DEBUG Servicemms_direct - 获取字段
2020-01-02 10:13:45,557 [12452] DEBUG Mms - select top 1 BillNo from mms_direct where  BillNo < '202001020001'and ProjectCode =  '201306030001' order by BillNo desc
2020-01-02 10:13:45,562 [12452] DEBUG Servicemms_direct - 获取字段
2020-01-02 10:13:45,562 [12452] DEBUG Mms - select top 1 BillNo from mms_direct where  BillNo >  '202001020001'and ProjectCode =  '201306030001' order by BillNo
2020-01-02 10:13:45,567 [12452] DEBUG Servicemms_direct - 获取字段
2020-01-02 10:13:45,568 [12452] DEBUG Mms - select top 1 BillNo from mms_direct where  ProjectCode =  '201306030001' order by BillNo desc
2020-01-02 10:13:45,613 [12452] DEBUG Servicesys_code - 获取动态列表
2020-01-02 10:13:45,614 [12452] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2020-01-02 10:13:45,615 [12452] DEBUG Servicesys_code - 获取动态列表
2020-01-02 10:13:45,615 [12452] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-02 10:13:45,616 [12452] DEBUG Servicesys_code - 获取动态列表
2020-01-02 10:13:45,616 [12452] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2020-01-02 10:13:45,616 [12452] DEBUG Servicesys_code - 获取动态列表
2020-01-02 10:13:45,616 [12452] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2020-01-02 10:13:45,617 [12452] DEBUG Servicesys_code - 获取字段
2020-01-02 10:13:45,618 [12452] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-02 10:13:45,620 [12452] DEBUG Servicesys_code - 获取字段
2020-01-02 10:13:45,620 [12452] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-02 10:13:47,694 [12204] DEBUG Servicemms_direct - 获取动态列表
2020-01-02 10:13:47,694 [12204] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_directDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '202001020001' order by A.MaterialCode
2020-01-02 10:13:53,413 [6580] DEBUG ServiceModelBase - 获取动态列表
2020-01-02 10:13:53,414 [6580] DEBUG Mms - select top 20 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  B.MerchantsProperty in ('采购') order by MerchantsCode
2020-01-02 10:13:53,423 [6580] DEBUG Mms - select count(*) from ( select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  B.MerchantsProperty in ('采购') ) tb_temp
2020-01-02 10:14:04,045 [12452] DEBUG ServiceModelBase - 获取动态列表
2020-01-02 10:14:04,046 [12452] DEBUG Mms - select top 20 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsName like '%新世纪%'and B.MerchantsProperty in ('采购') order by MerchantsCode
2020-01-02 10:14:04,054 [12452] DEBUG Mms - select count(*) from ( select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsName like '%新世纪%'and B.MerchantsProperty in ('采购') ) tb_temp
2020-01-02 10:14:05,097 [12772] DEBUG ServiceModelBase - 获取动态列表
2020-01-02 10:14:05,097 [12772] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('CG00303') order by MerchantsCode
2020-01-02 10:14:10,508 [1872] DEBUG ServiceModelBase - 获取动态列表
2020-01-02 10:14:10,508 [1872] DEBUG Mms - select 
    BuildPartCode as value,BuildPartName as text,ParentCode as pid
   from 
    mms_buildPart
   where  ProjectCode =  '201306030001' order by BuildPartCode
2020-01-02 10:14:13,124 [12772] DEBUG ServiceModelBase - 获取动态列表
2020-01-02 10:14:13,125 [12772] DEBUG Mms - select 
    BuildPartCode as value,BuildPartName as text,ParentCode as pid
   from 
    mms_buildPart
   where  BuildPartCode in ('2') order by BuildPartCode
2020-01-02 10:48:15,334 [8332] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-02 10:48:15,346 [8332] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-02 10:48:15,348 [8332] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-02 10:48:15,348 [8332] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-02 10:48:15,935 [8228] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2020-01-02 10:48:28,866 [13132] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2020-01-02 10:48:29,415 [12360] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-02 10:48:32,814 [7904] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/send/Index','/Mms/send')
2020-01-02 10:48:32,841 [7904] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-02 10:48:32,855 [7904] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-02 10:48:32,856 [7904] DEBUG Servicesys_code - 获取动态列表
2020-01-02 10:48:32,857 [7904] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2020-01-02 10:48:32,857 [7904] DEBUG Servicesys_code - 获取动态列表
2020-01-02 10:48:32,858 [7904] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2020-01-02 10:48:33,546 [7904] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2020-01-02 10:48:33,550 [7904] DEBUG Sys - 
select *
from sys_roleMenuColumnMap 
where MenuCode = '1001'
and RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'admin'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'admin'
)
2020-01-02 10:48:33,573 [7904] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2020-01-02 10:48:33,575 [7904] DEBUG Sys - 
select A.*
from sys_button A
inner join sys_roleMenuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
where RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'admin'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'admin'
)
order by ButtonSeq
2020-01-02 10:48:34,120 [13132] DEBUG Servicemms_send - 获取动态列表
2020-01-02 10:48:34,120 [13132] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-02 10:48:34,135 [13132] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-02 12:00:55,281 [13420] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2020-01-02 12:00:55,603 [4248] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-02 12:00:57,452 [11340] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/lossreport/Index','/Mms/lossreport')
2020-01-02 12:00:57,476 [11340] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-02 12:00:57,483 [11340] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-02 12:00:59,080 [13420] DEBUG Servicemms_lossReport - 获取动态列表
2020-01-02 12:00:59,081 [13420] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName
     from 
        mms_LossReport A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-02 12:00:59,113 [13420] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName
     from 
        mms_LossReport A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-02 12:01:03,895 [4248] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2020-01-02 12:01:03,900 [4248] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-02 12:01:03,900 [4248] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-02 12:01:03,901 [4248] DEBUG Servicesys_code - 获取动态列表
2020-01-02 12:01:03,902 [4248] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-02 12:01:05,547 [13420] DEBUG Servicemms_receive - 获取动态列表
2020-01-02 12:01:05,547 [13420] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-02 12:01:05,562 [13420] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-02 12:10:53,106 [11340] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/edit')
2020-01-02 12:10:53,127 [11340] DEBUG Servicemms_receive - 获取实体对象
2020-01-02 12:10:53,134 [11340] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201307030001'
2020-01-02 12:10:53,142 [11340] DEBUG Servicemms_receive - 获取上一条下一条数据
2020-01-02 12:10:53,180 [11340] DEBUG Servicemms_receive - 获取字段
2020-01-02 12:10:53,182 [11340] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2020-01-02 12:10:53,186 [11340] DEBUG Servicemms_receive - 获取字段
2020-01-02 12:10:53,187 [11340] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '201307030001'and ProjectCode =  '201306030001' order by BillNo desc
2020-01-02 12:10:53,191 [11340] DEBUG Servicemms_receive - 获取字段
2020-01-02 12:10:53,192 [11340] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '201307030001'and ProjectCode =  '201306030001' order by BillNo
2020-01-02 12:10:53,196 [11340] DEBUG Servicemms_receive - 获取字段
2020-01-02 12:10:53,196 [11340] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2020-01-02 12:10:53,259 [11340] DEBUG Servicesys_code - 获取动态列表
2020-01-02 12:10:53,260 [11340] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2020-01-02 12:10:53,261 [11340] DEBUG Servicesys_code - 获取动态列表
2020-01-02 12:10:53,261 [11340] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-02 12:10:53,261 [11340] DEBUG Servicesys_code - 获取动态列表
2020-01-02 12:10:53,261 [11340] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2020-01-02 12:10:53,262 [11340] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-02 12:10:53,263 [11340] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-02 12:10:53,264 [11340] DEBUG Servicesys_code - 获取字段
2020-01-02 12:10:53,265 [11340] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-02 12:10:53,265 [11340] DEBUG Servicesys_code - 获取字段
2020-01-02 12:10:53,265 [11340] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-02 12:10:54,664 [12036] DEBUG ServiceModelBase - 获取动态列表
2020-01-02 12:10:54,665 [12036] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('CG00304') order by MerchantsCode
2020-01-02 12:47:59,351 [14124] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/send/Index','/Mms/send')
2020-01-02 12:47:59,354 [14124] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-02 12:47:59,360 [14124] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-02 12:47:59,361 [14124] DEBUG Servicesys_code - 获取动态列表
2020-01-02 12:47:59,361 [14124] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2020-01-02 12:47:59,362 [14124] DEBUG Servicesys_code - 获取动态列表
2020-01-02 12:47:59,362 [14124] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2020-01-02 12:47:59,387 [14124] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2020-01-02 12:47:59,391 [14124] DEBUG Sys - 
select *
from sys_roleMenuColumnMap 
where MenuCode = '1001'
and RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'admin'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'admin'
)
2020-01-02 12:47:59,392 [14124] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2020-01-02 12:47:59,393 [14124] DEBUG Sys - 
select A.*
from sys_button A
inner join sys_roleMenuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
where RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'admin'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'admin'
)
order by ButtonSeq
2020-01-02 12:48:00,287 [8284] DEBUG Servicemms_send - 获取动态列表
2020-01-02 12:48:00,287 [8284] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-02 12:48:00,293 [8284] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-02 12:48:04,149 [8284] DEBUG Servicemms_send - 获取动态列表
2020-01-02 12:48:04,149 [8284] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-02 12:48:04,152 [8284] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-02 12:48:06,241 [6360] DEBUG Servicemms_send - 获取新主键
2020-01-02 12:48:06,243 [6360] DEBUG Mms - select isnull(max(BillNo),0) from mms_send
2020-01-02 12:48:06,297 [10552] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/send/edit')
2020-01-02 12:48:06,311 [10552] DEBUG Servicemms_send - 获取实体对象
2020-01-02 12:48:06,312 [10552] DEBUG Mms - select mms_send.* from mms_send where  BillNo =  '202001020001'
2020-01-02 12:48:06,317 [10552] DEBUG Servicemms_send - 获取上一条下一条数据
2020-01-02 12:48:06,319 [10552] DEBUG Servicemms_send - 获取字段
2020-01-02 12:48:06,319 [10552] DEBUG Mms - select top 1 BillNo from mms_send where  ProjectCode =  '201306030001' order by BillNo
2020-01-02 12:48:06,328 [10552] DEBUG Servicemms_send - 获取字段
2020-01-02 12:48:06,328 [10552] DEBUG Mms - select top 1 BillNo from mms_send where  BillNo < '202001020001'and ProjectCode =  '201306030001' order by BillNo desc
2020-01-02 12:48:06,336 [10552] DEBUG Servicemms_send - 获取字段
2020-01-02 12:48:06,336 [10552] DEBUG Mms - select top 1 BillNo from mms_send where  BillNo >  '202001020001'and ProjectCode =  '201306030001' order by BillNo
2020-01-02 12:48:06,341 [10552] DEBUG Servicemms_send - 获取字段
2020-01-02 12:48:06,341 [10552] DEBUG Mms - select top 1 BillNo from mms_send where  ProjectCode =  '201306030001' order by BillNo desc
2020-01-02 12:48:06,385 [10552] DEBUG Servicesys_code - 获取动态列表
2020-01-02 12:48:06,385 [10552] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2020-01-02 12:48:06,386 [10552] DEBUG Servicesys_code - 获取动态列表
2020-01-02 12:48:06,386 [10552] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2020-01-02 12:48:06,387 [10552] DEBUG Servicesys_code - 获取动态列表
2020-01-02 12:48:06,387 [10552] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2020-01-02 12:48:06,388 [10552] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-02 12:48:06,389 [10552] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-02 12:48:06,390 [10552] DEBUG Servicesys_code - 获取字段
2020-01-02 12:48:06,390 [10552] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'Pricing'and IsEnable =  'True'and IsDefault =  'True'
2020-01-02 12:48:08,492 [5868] DEBUG Servicemms_send - 获取动态列表
2020-01-02 12:48:08,493 [5868] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_sendDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '202001020001' order by A.MaterialCode
2020-01-02 12:48:12,171 [6360] DEBUG Servicemms_materialType - 获取动态列表
2020-01-02 12:48:12,171 [6360] DEBUG Mms - select 
        MaterialTypeName as text,MaterialType as id,ParentCode as pid
     from 
        mms_materialType
     order by MaterialType
2020-01-02 12:48:12,214 [10552] DEBUG Servicemms_material - 获取动态列表
2020-01-02 12:48:12,215 [10552] DEBUG Mms - select top 10 * from 
    (select 'receive' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.ReceiveDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_receiveDetail as A
    left join mms_receive as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'refund' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.RefundDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_refundDetail as A
    left join mms_refund as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'adjust' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.EffectDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_stockAdjustDetail as A
    left join mms_stockAdjust as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0) T
   where  WarehouseCode =  '' order by MaterialCode
2020-01-02 12:48:12,264 [10552] DEBUG Mms - select count(*) from ( select * from 
    (select 'receive' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.ReceiveDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_receiveDetail as A
    left join mms_receive as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'refund' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.RefundDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_refundDetail as A
    left join mms_refund as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'adjust' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.EffectDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_stockAdjustDetail as A
    left join mms_stockAdjust as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0) T
   where  WarehouseCode =  '' ) tb_temp
2020-01-02 12:48:16,988 [6360] DEBUG Servicemms_material - 获取动态列表
2020-01-02 12:48:16,989 [6360] DEBUG Mms - select top 10 * from 
    (select 'receive' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.ReceiveDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_receiveDetail as A
    left join mms_receive as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'refund' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.RefundDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_refundDetail as A
    left join mms_refund as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'adjust' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.EffectDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_stockAdjustDetail as A
    left join mms_stockAdjust as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0) T
   where  MaterialType like '01010206%'and WarehouseCode =  '' order by MaterialCode
2020-01-02 12:48:17,063 [6360] DEBUG Mms - select count(*) from ( select * from 
    (select 'receive' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.ReceiveDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_receiveDetail as A
    left join mms_receive as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'refund' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.RefundDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_refundDetail as A
    left join mms_refund as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'adjust' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.EffectDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_stockAdjustDetail as A
    left join mms_stockAdjust as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0) T
   where  MaterialType like '01010206%'and WarehouseCode =  '' ) tb_temp
2020-01-02 12:48:17,202 [10552] DEBUG Servicemms_material - 获取动态列表
2020-01-02 12:48:17,203 [10552] DEBUG Mms - select top 10 * from 
    (select 'receive' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.ReceiveDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_receiveDetail as A
    left join mms_receive as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'refund' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.RefundDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_refundDetail as A
    left join mms_refund as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'adjust' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.EffectDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_stockAdjustDetail as A
    left join mms_stockAdjust as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0) T
   where  MaterialType like '01010206%'and WarehouseCode =  '' order by MaterialCode
2020-01-02 12:48:17,205 [10552] DEBUG Mms - select count(*) from ( select * from 
    (select 'receive' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.ReceiveDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_receiveDetail as A
    left join mms_receive as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'refund' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.RefundDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_refundDetail as A
    left join mms_refund as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'adjust' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.EffectDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_stockAdjustDetail as A
    left join mms_stockAdjust as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0) T
   where  MaterialType like '01010206%'and WarehouseCode =  '' ) tb_temp
2020-01-02 12:48:18,745 [14124] DEBUG Servicemms_sendDetail - 获取新主键
2020-01-02 12:48:20,345 [6360] DEBUG Servicemms_materialType - 获取动态列表
2020-01-02 12:48:20,345 [6360] DEBUG Mms - select 
        MaterialTypeName as text,MaterialType as id,ParentCode as pid
     from 
        mms_materialType
     order by MaterialType
2020-01-02 12:48:20,392 [10552] DEBUG Servicemms_material - 获取动态列表
2020-01-02 12:48:20,392 [10552] DEBUG Mms - select top 10 * from 
    (select 'receive' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.ReceiveDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_receiveDetail as A
    left join mms_receive as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'refund' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.RefundDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_refundDetail as A
    left join mms_refund as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'adjust' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.EffectDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_stockAdjustDetail as A
    left join mms_stockAdjust as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0) T
   where  WarehouseCode =  '' order by MaterialCode
2020-01-02 12:48:20,393 [10552] DEBUG Mms - select count(*) from ( select * from 
    (select 'receive' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.ReceiveDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_receiveDetail as A
    left join mms_receive as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'refund' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.RefundDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_refundDetail as A
    left join mms_refund as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'adjust' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.EffectDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_stockAdjustDetail as A
    left join mms_stockAdjust as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0) T
   where  WarehouseCode =  '' ) tb_temp
2020-01-02 20:31:35,291 [5652] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-02 20:31:35,349 [5652] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-02 20:31:35,362 [5652] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-02 20:31:35,373 [5652] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-02 20:32:03,739 [10620] DEBUG Servicesys_user - 获取实体对象
2020-01-02 20:32:03,770 [10620] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  '1234'and IsEnable =  'True'
2020-01-02 20:32:04,035 [10620] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'admin' 
2020-01-02 20:32:04,176 [10620] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('admin','管理员','4S6DBKLDWJUEQVW','localhost','上海市','2020/1/2 20:32:04')
2020-01-02 20:32:04,191 [10620] DEBUG Servicemms_project - 获取实体对象
2020-01-02 20:32:04,191 [10620] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2020-01-02 20:32:04,314 [10608] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2020-01-02 20:32:07,099 [10612] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-02 20:32:21,941 [10452] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/check/Index','/Mms/check')
2020-01-02 20:32:21,980 [10452] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-02 20:32:21,982 [10452] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-02 20:32:24,889 [10608] DEBUG Servicemms_check - 获取动态列表
2020-01-02 20:32:24,890 [10608] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName
     from 
        mms_check A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
     where  1=1and A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-02 20:32:24,947 [10608] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName
     from 
        mms_check A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
     where  1=1and A.ProjectCode =  '201306030001' ) tb_temp
2020-01-02 20:32:28,007 [10604] DEBUG Servicemms_check - 获取新主键
2020-01-02 20:32:28,010 [10604] DEBUG Mms - select isnull(max(BillNo),0) from mms_check
2020-01-02 20:32:28,163 [10612] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/check/edit')
2020-01-02 20:32:28,188 [10612] DEBUG Servicemms_check - 获取实体对象
2020-01-02 20:32:28,189 [10612] DEBUG Mms - select mms_check.* from mms_check where  BillNo =  '202001020001'
2020-01-02 20:32:28,195 [10612] DEBUG Servicemms_check - 获取上一条下一条数据
2020-01-02 20:32:28,243 [10612] DEBUG Servicemms_check - 获取字段
2020-01-02 20:32:28,246 [10612] DEBUG Mms - select top 1 BillNo from mms_check where  ProjectCode =  '201306030001' order by BillNo
2020-01-02 20:32:28,256 [10612] DEBUG Servicemms_check - 获取字段
2020-01-02 20:32:28,257 [10612] DEBUG Mms - select top 1 BillNo from mms_check where  BillNo < '202001020001'and ProjectCode =  '201306030001' order by BillNo desc
2020-01-02 20:32:28,264 [10612] DEBUG Servicemms_check - 获取字段
2020-01-02 20:32:28,265 [10612] DEBUG Mms - select top 1 BillNo from mms_check where  BillNo >  '202001020001'and ProjectCode =  '201306030001' order by BillNo
2020-01-02 20:32:28,271 [10612] DEBUG Servicemms_check - 获取字段
2020-01-02 20:32:28,271 [10612] DEBUG Mms - select top 1 BillNo from mms_check where  ProjectCode =  '201306030001' order by BillNo desc
2020-01-02 20:32:28,329 [10612] DEBUG Servicesys_code - 获取动态列表
2020-01-02 20:32:28,330 [10612] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2020-01-02 20:32:28,334 [10612] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-02 20:32:28,334 [10612] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-02 20:32:30,700 [10604] DEBUG Servicemms_check - 获取动态列表
2020-01-02 20:32:30,700 [10604] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_checkDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '202001020001' order by A.MaterialCode
2020-01-02 20:32:33,505 [10612] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/material/Index','/Mms/material')
2020-01-02 20:32:35,190 [10620] DEBUG Servicemms_materialType - 获取动态列表
2020-01-02 20:32:35,191 [10620] DEBUG Mms - select mms_materialType.* from mms_materialType order by MaterialType
2020-01-02 20:32:35,377 [10608] DEBUG Servicemms_material - 获取实体列表
2020-01-02 20:32:35,380 [10608] DEBUG Mms - select top 20 mms_material.* from mms_material order by MaterialCode
2020-01-02 20:32:35,407 [10608] DEBUG Mms - select count(*) from ( select mms_material.* from mms_material ) tb_temp
2020-01-02 20:32:42,524 [10620] DEBUG Servicemms_material - 获取实体列表
2020-01-02 20:32:42,525 [10620] DEBUG Mms - select top 20 mms_material.* from mms_material where  MaterialType =  '0002' order by MaterialCode
2020-01-02 20:32:42,530 [10620] DEBUG Mms - select count(*) from ( select mms_material.* from mms_material where  MaterialType =  '0002' ) tb_temp
2020-01-02 20:32:51,560 [10616] DEBUG Servicemms_material - 获取实体列表
2020-01-02 20:32:51,561 [10616] DEBUG Mms - select top 20 mms_material.* from mms_material where  MaterialType =  '00' order by MaterialCode
2020-01-02 20:32:51,567 [10616] DEBUG Mms - select count(*) from ( select mms_material.* from mms_material where  MaterialType =  '00' ) tb_temp
2020-01-02 20:33:31,171 [10616] DEBUG Mms - select max(MaterialCode) 
from mms_material 
where MaterialType='00'
2020-01-02 20:33:52,400 [10608] DEBUG Servicemms_materialType - 获取动态列表
2020-01-02 20:33:52,400 [10608] DEBUG Mms - select mms_materialType.* from mms_materialType order by MaterialType
2020-01-02 20:33:59,251 [10604] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/material/Index','/Mms/material')
2020-01-02 20:33:59,991 [10456] DEBUG Servicemms_material - 获取实体列表
2020-01-02 20:33:59,991 [10456] DEBUG Mms - select top 20 mms_material.* from mms_material order by MaterialCode
2020-01-02 20:33:59,994 [10456] DEBUG Mms - select count(*) from ( select mms_material.* from mms_material ) tb_temp
2020-01-02 20:34:00,046 [10612] DEBUG Servicemms_materialType - 获取动态列表
2020-01-02 20:34:00,047 [10612] DEBUG Mms - select mms_materialType.* from mms_materialType order by MaterialType
2020-01-02 20:34:02,757 [10616] DEBUG Servicemms_material - 获取实体列表
2020-01-02 20:34:02,758 [10616] DEBUG Mms - select top 20 mms_material.* from mms_material where  MaterialType =  '00' order by MaterialCode
2020-01-02 20:34:02,762 [10616] DEBUG Mms - select count(*) from ( select mms_material.* from mms_material where  MaterialType =  '00' ) tb_temp
2020-01-02 20:34:03,484 [10608] DEBUG Servicemms_material - 获取实体列表
2020-01-02 20:34:03,484 [10608] DEBUG Mms - select top 20 mms_material.* from mms_material where  MaterialType =  '01' order by MaterialCode
2020-01-02 20:34:03,491 [10608] DEBUG Mms - select count(*) from ( select mms_material.* from mms_material where  MaterialType =  '01' ) tb_temp
2020-01-02 20:34:07,146 [10612] DEBUG Servicemms_material - 获取实体列表
2020-01-02 20:34:07,146 [10612] DEBUG Mms - select top 20 mms_material.* from mms_material order by MaterialCode
2020-01-02 20:34:07,150 [10612] DEBUG Mms - select count(*) from ( select mms_material.* from mms_material ) tb_temp
2020-01-02 20:34:11,483 [10808] DEBUG Servicemms_material - 获取实体列表
2020-01-02 20:34:11,483 [10808] DEBUG Mms - select top 20 mms_material.* from mms_material where  MaterialType =  '01' order by MaterialCode
2020-01-02 20:34:11,490 [10808] DEBUG Mms - select count(*) from ( select mms_material.* from mms_material where  MaterialType =  '01' ) tb_temp
2020-01-02 20:34:16,735 [10612] DEBUG Servicemms_materialType - 获取动态列表
2020-01-02 20:34:16,736 [10612] DEBUG Mms - select mms_materialType.* from mms_materialType order by MaterialType
2020-01-02 20:34:39,572 [10620] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/warehouse/Index','/Mms/warehouse')
2020-01-02 20:34:41,040 [10808] DEBUG Servicemms_project - 获取动态列表
2020-01-02 20:34:41,041 [10808] DEBUG Mms - select ProjectName as text,ProjectCode as id,ParentCode as pid from mms_project
2020-01-02 20:34:41,194 [10452] DEBUG Servicemms_warehouse - 获取实体列表
2020-01-02 20:34:41,195 [10452] DEBUG Mms - select top 20 mms_warehouse.* from mms_warehouse order by WarehouseCode
2020-01-02 20:34:41,209 [10452] DEBUG Mms - select count(*) from ( select mms_warehouse.* from mms_warehouse ) tb_temp
2020-01-02 20:34:45,954 [10808] DEBUG Servicemms_warehouse - 获取实体列表
2020-01-02 20:34:45,954 [10808] DEBUG Mms - select top 20 mms_warehouse.* from mms_warehouse where  ProjectCode =  '201306030002' order by WarehouseCode
2020-01-02 20:34:45,958 [10808] DEBUG Mms - select count(*) from ( select mms_warehouse.* from mms_warehouse where  ProjectCode =  '201306030002' ) tb_temp
2020-01-02 20:34:46,898 [10616] DEBUG Servicemms_warehouse - 获取实体列表
2020-01-02 20:34:46,898 [10616] DEBUG Mms - select top 20 mms_warehouse.* from mms_warehouse where  ProjectCode =  '201306030001' order by WarehouseCode
2020-01-02 20:34:46,902 [10616] DEBUG Mms - select count(*) from ( select mms_warehouse.* from mms_warehouse where  ProjectCode =  '201306030001' ) tb_temp
2020-01-02 20:34:57,366 [10620] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/merchant/Index','/Mms/merchant')
2020-01-02 20:34:59,278 [10452] DEBUG Servicemms_merchants - 获取实体列表
2020-01-02 20:34:59,279 [10452] DEBUG Mms - select top 20 mms_merchants.* from mms_merchants order by MerchantsCode
2020-01-02 20:34:59,312 [10452] DEBUG Mms - select count(*) from ( select mms_merchants.* from mms_merchants ) tb_temp
2020-01-02 20:34:59,371 [10604] DEBUG Servicemms_merchantsType - 获取动态列表
2020-01-02 20:34:59,372 [10604] DEBUG Mms - select mms_merchantsType.* from mms_merchantsType order by MerchantsTypeCode
2020-01-02 20:35:03,279 [10608] DEBUG Servicemms_merchants - 获取实体列表
2020-01-02 20:35:03,279 [10608] DEBUG Mms - select top 20 mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '003' order by MerchantsCode
2020-01-02 20:35:03,295 [10608] DEBUG Mms - select count(*) from ( select mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '003' ) tb_temp
2020-01-02 20:35:04,765 [10616] DEBUG Servicemms_merchants - 获取实体列表
2020-01-02 20:35:04,766 [10616] DEBUG Mms - select top 20 mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '007' order by MerchantsCode
2020-01-02 20:35:04,772 [10616] DEBUG Mms - select count(*) from ( select mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '007' ) tb_temp
2020-01-02 20:35:10,706 [10808] DEBUG Servicemms_merchantsType - 获取动态列表
2020-01-02 20:35:10,707 [10808] DEBUG Mms - select top 10 mms_merchantsType.* from mms_merchantsType order by MerchantsTypeCode
2020-01-02 20:35:10,710 [10808] DEBUG Mms - select count(*) from ( select mms_merchantsType.* from mms_merchantsType ) tb_temp
2020-01-02 20:35:29,072 [10604] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/send/Index','/Mms/send')
2020-01-02 20:35:29,089 [10604] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-02 20:35:29,090 [10604] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-02 20:35:29,104 [10604] DEBUG Servicesys_code - 获取动态列表
2020-01-02 20:35:29,105 [10604] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2020-01-02 20:35:29,122 [10604] DEBUG Servicesys_code - 获取动态列表
2020-01-02 20:35:29,123 [10604] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2020-01-02 20:35:30,696 [10604] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2020-01-02 20:35:30,700 [10604] DEBUG Sys - 
select *
from sys_roleMenuColumnMap 
where MenuCode = '1001'
and RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'admin'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'admin'
)
2020-01-02 20:35:30,756 [10604] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2020-01-02 20:35:30,757 [10604] DEBUG Sys - 
select A.*
from sys_button A
inner join sys_roleMenuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
where RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'admin'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'admin'
)
order by ButtonSeq
2020-01-02 20:35:32,061 [10608] DEBUG Servicemms_send - 获取动态列表
2020-01-02 20:35:32,062 [10608] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-02 20:35:32,106 [10608] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-02 20:49:16,565 [5652] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-02 20:49:16,582 [5652] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-02 20:49:16,586 [5652] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-02 20:49:16,587 [5652] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-02 20:49:16,590 [5652] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-02 20:49:16,593 [5652] DEBUG Erp - 
--set ANSI_NULLS ON
--set QUOTED_IDENTIFIER ON
 
-- =============================================
-- Description:	提供中文首字母
-- Demo: select * from 表 where fun_getPY(字段) like N'%zgr%'
-- =============================================
CREATE FUNCTION [dbo].[fun_getPY]
(
	@str NVARCHAR(4000)
)
RETURNS NVARCHAR(4000)
AS
BEGIN
	DECLARE @word NCHAR(1),@PY NVARCHAR(4000)
	SET @PY=''
	WHILE len(@str)>0
	BEGIN
		SET @word=left(@str,1)
		SET @PY=@PY+(CASE WHEN unicode(@word) BETWEEN 19968 AND 19968+20901
		THEN (SELECT TOP 1 PY FROM (
		SELECT 'A' AS PY,N'' AS word
		UNION ALL SELECT 'B',N'簿'
		UNION ALL SELECT 'C',N'e'
		UNION ALL SELECT 'D',N'z'
		UNION ALL SELECT 'E',N''
		UNION ALL SELECT 'F',N'v'
		UNION ALL SELECT 'G',N'B'
		UNION ALL SELECT 'H',N''
		UNION ALL SELECT 'J',N'h'
		UNION ALL SELECT 'K',N'i'
		UNION ALL SELECT 'L',N'w'
		UNION ALL SELECT 'M',N''
		UNION ALL SELECT 'N',N''
		UNION ALL SELECT 'O',N'a'
		UNION ALL SELECT 'P',N'曝'
		UNION ALL SELECT 'Q',N''
		UNION ALL SELECT 'R',N'U'
		UNION ALL SELECT 'S',N'R'
		UNION ALL SELECT 'T',N'X'
		UNION ALL SELECT 'W',N'F'
		UNION ALL SELECT 'X',N'R'
		UNION ALL SELECT 'Y',N''
		UNION ALL SELECT 'Z',N''
		) T 
		WHERE word>=@word COLLATE Chinese_PRC_CS_AS_KS_WS 
		ORDER BY PY ASC) ELSE @word END)
		SET @str=right(@str,len(@str)-1)
	END
	RETURN @PY
END
2020-01-02 20:49:16,596 [5652] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-02 20:49:16,910 [8488] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Erp/Material/Index','/Erp/Material')
2020-01-02 20:49:34,268 [10936] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2020-01-02 20:49:37,255 [9344] DEBUG Servicesys_menu - 获取动态列表
2020-01-02 20:49:37,264 [9344] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2020-01-02 20:51:08,762 [8488] DEBUG Sys - 
select A.*,
       case when B.ID is null then 0 else 1 end as Selected
from sys_button A
left join sys_menuButtonMap B on B.MenuCode = '10000' and B.ButtonCode = A.ButtonCode
order by ButtonSeq
2020-01-02 20:51:15,859 [8488] DEBUG Servicesys_menu - 设置菜单按钮
2020-01-02 20:51:15,895 [8488] DEBUG Sys - delete from sys_menuButtonMap where [MenuCode] = '10000'
2020-01-02 20:51:15,907 [8488] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('10000','add')
2020-01-02 20:51:15,932 [8488] ERROR Servicesys_menu - 设置菜单按钮失败
System.Exception: 数据已经被引用，更新失败，请先删除引用数据并重试！
   在 Zephyr.Core.Db.<>c.<Context>b__2_1(ErrorEventArgs e) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Core\Db.cs:行号 98
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 105
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.Execute() 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\Execute.cs:行号 9
   在 Zephyr.Data.BaseInsertBuilder.Execute() 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Builders\Insert\BaseInsertBuilder.cs:行号 22
   在 ERP.Web.Models.sys_menuService.<>c__DisplayClass4_0.<SaveMenuButtons>b__0() 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Sys\Models\sys_menu.cs:行号 135
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
2020-01-02 20:51:16,004 [8488] ERROR /api/sys/menu/editmenubuttons/10000 - System.Exception: 数据已经被引用，更新失败，请先删除引用数据并重试！
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 ERP.Web.Models.sys_menuService.SaveMenuButtons(String MenuCode, JToken ButtonList) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Sys\Models\sys_menu.cs:行号 129
   在 ERP.Web.Areas.Sys.Controllers.MenuApiController.EditMenuButtons(String id, Object data) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Sys\Controllers\MenuController.cs:行号 88
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClassf.<GetExecutor>b__9(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
2020-01-02 20:51:46,800 [6032] DEBUG Servicesys_menu - 设置菜单按钮
2020-01-02 20:51:46,801 [6032] DEBUG Sys - delete from sys_menuButtonMap where [MenuCode] = '10000'
2020-01-02 20:51:46,802 [6032] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('10000','add')
2020-01-02 20:51:46,806 [6032] ERROR Servicesys_menu - 设置菜单按钮失败
System.Exception: 数据已经被引用，更新失败，请先删除引用数据并重试！
   在 Zephyr.Core.Db.<>c.<Context>b__2_1(ErrorEventArgs e) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Core\Db.cs:行号 98
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 105
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.Execute() 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\Execute.cs:行号 9
   在 Zephyr.Data.BaseInsertBuilder.Execute() 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Builders\Insert\BaseInsertBuilder.cs:行号 22
   在 ERP.Web.Models.sys_menuService.<>c__DisplayClass4_0.<SaveMenuButtons>b__0() 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Sys\Models\sys_menu.cs:行号 135
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
2020-01-02 20:51:46,820 [6032] ERROR /api/sys/menu/editmenubuttons/10000 - System.Exception: 数据已经被引用，更新失败，请先删除引用数据并重试！
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 ERP.Web.Models.sys_menuService.SaveMenuButtons(String MenuCode, JToken ButtonList) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Sys\Models\sys_menu.cs:行号 129
   在 ERP.Web.Areas.Sys.Controllers.MenuApiController.EditMenuButtons(String id, Object data) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Sys\Controllers\MenuController.cs:行号 88
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClassf.<GetExecutor>b__9(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
2020-01-02 20:51:51,571 [6028] DEBUG Sys - 
select A.*,
       case when B.ID is null then 0 else 1 end as Selected
from sys_button A
left join sys_menuButtonMap B on B.MenuCode = '1203' and B.ButtonCode = A.ButtonCode
order by ButtonSeq
2020-01-02 20:51:58,741 [9344] DEBUG Sys - 
select A.*,
       case when B.ID is null then 0 else 1 end as Selected
from sys_button A
left join sys_menuButtonMap B on B.MenuCode = '9903' and B.ButtonCode = A.ButtonCode
order by ButtonSeq
2020-01-02 20:52:26,575 [11148] DEBUG Servicesys_menu - 编辑记录
2020-01-02 20:52:26,619 [11148] DEBUG Servicesys_menu - 获取动态对象
2020-01-02 20:52:26,628 [11148] DEBUG Sys - select 
        sys_menu
    .* from 
        sys_menu
     where  MenuCode =  '5e489818-9c27-4721-91a3-08a44055bf12'
2020-01-02 20:52:26,656 [11148] DEBUG Sys - insert into 
        sys_menu
    ([MenuName],[MenuCode],[ParentCode],[IconClass],[URL],[IsVisible],[IsEnable],[MenuSeq],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('基础资料','10000','0','icon-chart_bar','/erp/material','true','true','70','管理员','2020/1/2 20:52:26','管理员','2020/1/2 20:52:26')
2020-01-02 20:52:26,675 [11148] DEBUG Servicesys_menu - 获取动态对象
2020-01-02 20:52:26,675 [11148] DEBUG Sys - select 
        sys_menu
    .* from 
        sys_menu
     where  MenuCode =  '9911'
2020-01-02 20:52:26,700 [11148] DEBUG Sys - update 
        sys_menu
     set [MenuName] = '系统参数', [MenuCode] = '9911', [ParentCode] = '99', [IconClass] = 'icon-page_white_wrench', [URL] = '/sys/parameter', [IsVisible] = 'true', [IsEnable] = 'true', [MenuSeq] = '255', [UpdatePerson] = '管理员', [UpdateDate] = '2020/1/2 20:52:26' where  MenuCode =  '9911'
2020-01-02 20:52:26,728 [11148] DEBUG Servicesys_menu - 获取动态对象
2020-01-02 20:52:26,728 [11148] DEBUG Sys - select 
        sys_menu
    .* from 
        sys_menu
     where  MenuCode =  '1203'
2020-01-02 20:52:26,730 [11148] DEBUG Sys - update 
        sys_menu
     set [MenuName] = '材料字典', [MenuCode] = '1203', [ParentCode] = '12', [IconClass] = 'icon-cdr_stop_alt', [URL] = '/mms/material', [IsVisible] = 'true', [IsEnable] = 'true', [MenuSeq] = '1230', [UpdatePerson] = '管理员', [UpdateDate] = '2020/1/2 20:52:26' where  MenuCode =  '1203'
2020-01-02 20:52:26,796 [11148] DEBUG Sys - insert into sys_log([UserCode],[UserName],[Position],[Target],[Type],[Message],[Date]) values('admin','管理员','api/mms/send','菜单数据','修改','{"list":{"deleted":[],"inserted":[{"_id":"5e489818-9c27-4721-91a3-08a44055bf12","MenuName":"基础资料","MenuCode":"10000","ParentCode":"0","IconClass":"icon-chart_bar","URL":"/erp/material","IsVisible":"true","IsEnable":"true","MenuSeq":"70"}],"updated":[{"_id":"9911","MenuName":"系统参数","MenuCode":"9911","ParentCode":"99","IconClass":"icon-page_white_wrench","URL":"/sys/parameter","IsVisible":"true","IsEnable":"true","MenuSeq":"255"},{"_id":"1203","MenuName":"材料字典","MenuCode":"1203","ParentCode":"12","IconClass":"icon-cdr_stop_alt","URL":"/mms/material","IsVisible":"true","IsEnable":"true","MenuSeq":"1230"}],"_changed":true}}','2020/1/2 20:52:26')
2020-01-02 20:52:27,049 [6028] DEBUG Servicesys_menu - 获取动态列表
2020-01-02 20:52:27,049 [6028] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2020-01-02 20:52:30,149 [8488] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/organize/Index','/Sys/organize')
2020-01-02 20:52:30,171 [8488] DEBUG Servicesys_organize - 获取实体列表
2020-01-02 20:52:30,174 [8488] DEBUG Sys - select sys_organize.* from sys_organize
2020-01-02 20:52:31,716 [9344] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/permission/Index','/Sys/permission')
2020-01-02 20:52:33,400 [6912] DEBUG Servicesys_permission - 获取动态列表
2020-01-02 20:52:33,400 [6912] DEBUG Sys - select A.*,B.PermissionName as ParentName from sys_permission A left join sys_permission B on B.PermissionCode = A.ParentCode
2020-01-02 20:52:38,657 [6032] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/code/Index','/Sys/code')
2020-01-02 20:52:40,330 [6028] DEBUG Servicesys_codeType - 获取动态列表
2020-01-02 20:52:40,331 [6028] DEBUG Sys - select sys_codeType.* from sys_codeType order by Seq,CodeType
2020-01-02 20:52:40,518 [6032] DEBUG Servicesys_code - 获取实体列表
2020-01-02 20:52:40,519 [6032] DEBUG Sys - select top 20 sys_code.* from sys_code order by Seq
2020-01-02 20:52:40,537 [6032] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code ) tb_temp
2020-01-02 20:52:42,025 [8488] DEBUG Servicesys_code - 获取实体列表
2020-01-02 20:52:42,026 [8488] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'QualificationLevel' order by Seq
2020-01-02 20:52:42,037 [8488] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'QualificationLevel' ) tb_temp
2020-01-02 20:52:43,049 [9344] DEBUG Servicesys_code - 获取实体列表
2020-01-02 20:52:43,050 [9344] DEBUG Sys - select top 20 sys_code.* from sys_code where  CodeType =  'KeyProjects' order by Seq
2020-01-02 20:52:43,055 [9344] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where  CodeType =  'KeyProjects' ) tb_temp
2020-01-02 20:52:44,758 [10084] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/parameter/Index','/Sys/parameter')
2020-01-02 20:52:46,405 [6912] DEBUG Servicesys_parameter - 获取实体列表
2020-01-02 20:52:46,406 [6912] DEBUG Sys - select top 20 sys_parameter.* from sys_parameter order by ParamCode
2020-01-02 20:52:46,423 [6912] DEBUG Sys - select count(*) from ( select sys_parameter.* from sys_parameter ) tb_temp
2020-01-02 20:52:54,862 [11148] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2020-01-02 20:52:55,355 [10084] DEBUG Servicesys_menu - 获取动态列表
2020-01-02 20:52:55,355 [10084] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2020-01-02 20:52:58,865 [11148] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/role/Index','/Sys/role')
2020-01-02 20:52:58,882 [11148] DEBUG Servicesys_user - 获取动态列表
2020-01-02 20:52:58,883 [11148] DEBUG Sys - select UserCode,UserName from sys_user
2020-01-02 20:52:58,885 [11148] DEBUG Servicesys_organize - 获取动态列表
2020-01-02 20:52:58,886 [11148] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2020-01-02 20:53:00,297 [6032] DEBUG Servicesys_role - 获取实体列表
2020-01-02 20:53:00,298 [6032] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2020-01-02 20:53:04,613 [9344] DEBUG Sys - select * from sys_button order by ButtonSeq
2020-01-02 20:53:04,622 [9344] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='super' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='super'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='super'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='super'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='super'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='super'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='super'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='super'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='super'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='super'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='super'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='super'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='super'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='super'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='super'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2020-01-02 20:53:04,684 [6912] DEBUG Servicesys_permission - 获取动态列表
2020-01-02 20:53:04,684 [6912] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='super' and B.PermissionCode = A.PermissionCode 
2020-01-02 20:53:04,872 [9344] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'super'
2020-01-02 20:53:46,831 [10084] DEBUG Servicesys_role - 修改角色菜单权限
2020-01-02 20:53:46,833 [10084] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'super'
2020-01-02 20:53:46,837 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10')
2020-01-02 20:53:46,842 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1019')
2020-01-02 20:53:46,846 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1002')
2020-01-02 20:53:46,847 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1001')
2020-01-02 20:53:46,848 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1009')
2020-01-02 20:53:46,849 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1010')
2020-01-02 20:53:46,850 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1013')
2020-01-02 20:53:46,851 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1007')
2020-01-02 20:53:46,851 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1006')
2020-01-02 20:53:46,852 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1011')
2020-01-02 20:53:46,853 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1003')
2020-01-02 20:53:46,854 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1012')
2020-01-02 20:53:46,855 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1008')
2020-01-02 20:53:46,856 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1005')
2020-01-02 20:53:46,858 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1004')
2020-01-02 20:53:46,859 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0101')
2020-01-02 20:53:46,860 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100101')
2020-01-02 20:53:46,864 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100201')
2020-01-02 20:53:46,865 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100312')
2020-01-02 20:53:46,866 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100401')
2020-01-02 20:53:46,867 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100501')
2020-01-02 20:53:46,868 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100601')
2020-01-02 20:53:46,869 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100701')
2020-01-02 20:53:46,869 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100801')
2020-01-02 20:53:46,870 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100901')
2020-01-02 20:53:46,871 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101001')
2020-01-02 20:53:46,872 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101101')
2020-01-02 20:53:46,873 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101201')
2020-01-02 20:53:46,873 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101301')
2020-01-02 20:53:46,874 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','11')
2020-01-02 20:53:46,875 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1105')
2020-01-02 20:53:46,876 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1101')
2020-01-02 20:53:46,877 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1102')
2020-01-02 20:53:46,878 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1103')
2020-01-02 20:53:46,878 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1104')
2020-01-02 20:53:46,879 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1109')
2020-01-02 20:53:46,880 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','03')
2020-01-02 20:53:46,881 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0301')
2020-01-02 20:53:46,881 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0302')
2020-01-02 20:53:46,882 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0303')
2020-01-02 20:53:46,883 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0304')
2020-01-02 20:53:46,884 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','12')
2020-01-02 20:53:46,885 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1204')
2020-01-02 20:53:46,886 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1201')
2020-01-02 20:53:46,887 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1202')
2020-01-02 20:53:46,887 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1203')
2020-01-02 20:53:46,888 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','99')
2020-01-02 20:53:46,889 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9902')
2020-01-02 20:53:46,890 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9903')
2020-01-02 20:53:46,891 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9910')
2020-01-02 20:53:46,891 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9904')
2020-01-02 20:53:46,892 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9905')
2020-01-02 20:53:46,894 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9906')
2020-01-02 20:53:46,896 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9911')
2020-01-02 20:53:46,897 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9907')
2020-01-02 20:53:46,897 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','98')
2020-01-02 20:53:46,898 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9810')
2020-01-02 20:53:46,899 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9915')
2020-01-02 20:53:46,900 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9920')
2020-01-02 20:53:46,901 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9950')
2020-01-02 20:53:46,901 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9960')
2020-01-02 20:53:46,902 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9961')
2020-01-02 20:53:46,903 [10084] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10000')
2020-01-02 20:53:46,913 [10084] DEBUG Servicesys_role - 修改角色菜单按钮权限
2020-01-02 20:53:46,915 [10084] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'super'
2020-01-02 20:53:46,919 [10084] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','add')
2020-01-02 20:53:46,925 [10084] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','edit')
2020-01-02 20:53:46,932 [10084] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','delete')
2020-01-02 20:53:46,942 [10084] DEBUG Servicesys_role - 修改角色数据权限
2020-01-02 20:53:46,944 [10084] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'super'
2020-01-02 20:53:46,948 [10084] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('super','0102','0')
2020-01-02 20:53:46,958 [10084] DEBUG Servicesys_role - 修改角色数据列权限
2020-01-02 20:53:46,963 [10084] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'super'
2020-01-02 20:53:46,979 [10084] DEBUG Sys - insert into sys_roleMenuColumnMap([RoleCode],[MenuCode],[IsReject],[FieldName]) values('super','1001','True','BillNo')
2020-01-02 20:53:49,373 [6032] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2020-01-02 20:53:53,360 [6028] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-02 20:53:53,918 [6912] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/role/Index','/Sys/role')
2020-01-02 20:53:53,936 [6912] DEBUG Servicesys_user - 获取动态列表
2020-01-02 20:53:53,936 [6912] DEBUG Sys - select UserCode,UserName from sys_user
2020-01-02 20:53:53,938 [6912] DEBUG Servicesys_organize - 获取动态列表
2020-01-02 20:53:53,939 [6912] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2020-01-02 20:53:54,287 [10084] DEBUG Servicesys_role - 获取实体列表
2020-01-02 20:53:54,287 [10084] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2020-01-02 20:54:31,767 [11148] DEBUG Servicesys_user - 获取实体对象
2020-01-02 20:54:31,770 [11148] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  '1234'and IsEnable =  'True'
2020-01-02 20:54:31,781 [11148] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'admin' 
2020-01-02 20:54:31,796 [11148] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('admin','管理员','4S6DBKLDWJUEQVW','localhost','上海市','2020/1/2 20:54:31')
2020-01-02 20:54:31,800 [11148] DEBUG Servicemms_project - 获取实体对象
2020-01-02 20:54:31,801 [11148] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2020-01-02 20:54:31,863 [10936] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2020-01-02 20:54:32,183 [6028] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-02 20:54:39,627 [8488] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2020-01-02 20:54:40,233 [6032] DEBUG Servicesys_menu - 获取动态列表
2020-01-02 20:54:40,233 [6032] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2020-01-02 20:54:46,778 [8488] DEBUG Sys - 
select A.*,
       case when B.ID is null then 0 else 1 end as Selected
from sys_button A
left join sys_menuButtonMap B on B.MenuCode = '10000' and B.ButtonCode = A.ButtonCode
order by ButtonSeq
2020-01-02 20:54:50,627 [10936] DEBUG Servicesys_menu - 设置菜单按钮
2020-01-02 20:54:50,628 [10936] DEBUG Sys - delete from sys_menuButtonMap where [MenuCode] = '10000'
2020-01-02 20:54:50,629 [10936] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('10000','edit')
2020-01-02 20:54:53,189 [10084] DEBUG Sys - 
select A.*,
       case when B.ID is null then 0 else 1 end as Selected
from sys_button A
left join sys_menuButtonMap B on B.MenuCode = '10000' and B.ButtonCode = A.ButtonCode
order by ButtonSeq
2020-01-02 20:54:56,744 [10936] DEBUG Servicesys_menu - 设置菜单按钮
2020-01-02 20:54:56,747 [10936] DEBUG Sys - delete from sys_menuButtonMap where [MenuCode] = '10000'
2020-01-02 20:55:28,509 [11148] DEBUG Servicesys_menu - 编辑记录
2020-01-02 20:55:28,510 [11148] DEBUG Servicesys_menu - 获取动态对象
2020-01-02 20:55:28,511 [11148] DEBUG Sys - select 
        sys_menu
    .* from 
        sys_menu
     where  MenuCode =  '10000'
2020-01-02 20:55:28,513 [11148] DEBUG Sys - update 
        sys_menu
     set [MenuName] = '基础资料', [MenuCode] = '10000', [ParentCode] = '0', [IconClass] = 'icon-chart_bar', [URL] = '', [IsVisible] = 'true', [IsEnable] = 'true', [MenuSeq] = '70', [UpdatePerson] = '管理员', [UpdateDate] = '2020/1/2 20:55:28' where  MenuCode =  '10000'
2020-01-02 20:55:28,555 [11148] DEBUG Sys - insert into sys_log([UserCode],[UserName],[Position],[Target],[Type],[Message],[Date]) values('admin','管理员','api/mms/send','菜单数据','修改','{"list":{"deleted":[],"inserted":[],"updated":[{"_id":"10000","MenuName":"基础资料","MenuCode":"10000","ParentCode":"0","IconClass":"icon-chart_bar","URL":"","IsVisible":"true","IsEnable":"true","MenuSeq":"70"}],"_changed":true}}','2020/1/2 20:55:28')
2020-01-02 20:55:28,777 [10084] DEBUG Servicesys_menu - 获取动态列表
2020-01-02 20:55:28,778 [10084] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2020-01-02 20:56:19,191 [3948] DEBUG Servicesys_menu - 编辑记录
2020-01-02 20:56:19,191 [3948] DEBUG Servicesys_menu - 获取动态对象
2020-01-02 20:56:19,192 [3948] DEBUG Sys - select 
        sys_menu
    .* from 
        sys_menu
     where  MenuCode =  'cb580d4e-a3ec-4787-9948-8fb456622a2a'
2020-01-02 20:56:19,194 [3948] DEBUG Sys - insert into 
        sys_menu
    ([MenuName],[MenuCode],[ParentCode],[IconClass],[URL],[IsVisible],[IsEnable],[MenuSeq],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('物料管理','10001','10000','icon-calendar_select_day','/erp/material','true','true','1','管理员','2020/1/2 20:56:19','管理员','2020/1/2 20:56:19')
2020-01-02 20:56:19,199 [3948] DEBUG Sys - insert into sys_log([UserCode],[UserName],[Position],[Target],[Type],[Message],[Date]) values('admin','管理员','api/mms/send','菜单数据','修改','{"list":{"deleted":[],"inserted":[{"_id":"cb580d4e-a3ec-4787-9948-8fb456622a2a","MenuName":"物料管理","MenuCode":"10001","ParentCode":"10000","IconClass":"icon-calendar_select_day","URL":"/erp/material","IsVisible":"true","IsEnable":"true","MenuSeq":"1"}],"updated":[],"_changed":true}}','2020/1/2 20:56:19')
2020-01-02 20:56:19,434 [6028] DEBUG Servicesys_menu - 获取动态列表
2020-01-02 20:56:19,434 [6028] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2020-01-02 20:56:22,967 [10936] DEBUG Sys - 
select A.*,
       case when B.ID is null then 0 else 1 end as Selected
from sys_button A
left join sys_menuButtonMap B on B.MenuCode = '10001' and B.ButtonCode = A.ButtonCode
order by ButtonSeq
2020-01-02 20:56:31,451 [6912] DEBUG Servicesys_menu - 设置菜单按钮
2020-01-02 20:56:31,453 [6912] DEBUG Sys - delete from sys_menuButtonMap where [MenuCode] = '10001'
2020-01-02 20:56:31,454 [6912] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('10001','add')
2020-01-02 20:56:31,455 [6912] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('10001','edit')
2020-01-02 20:56:31,461 [6912] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('10001','delete')
2020-01-02 20:56:31,486 [6912] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('10001','refresh')
2020-01-02 20:56:31,492 [6912] DEBUG Sys - insert into sys_menuButtonMap([MenuCode],[ButtonCode]) values('10001','save')
2020-01-02 20:56:37,925 [6028] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/role/Index','/Sys/role')
2020-01-02 20:56:37,929 [6028] DEBUG Servicesys_user - 获取动态列表
2020-01-02 20:56:37,929 [6028] DEBUG Sys - select UserCode,UserName from sys_user
2020-01-02 20:56:37,930 [6028] DEBUG Servicesys_organize - 获取动态列表
2020-01-02 20:56:37,930 [6028] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2020-01-02 20:56:38,486 [9344] DEBUG Servicesys_role - 获取实体列表
2020-01-02 20:56:38,486 [9344] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2020-01-02 20:56:41,773 [10084] DEBUG Sys - select * from sys_button order by ButtonSeq
2020-01-02 20:56:41,776 [10084] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='super' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='super'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='super'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='super'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='super'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='super'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='super'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='super'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='super'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='super'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='super'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='super'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='super'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='super'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='super'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2020-01-02 20:56:41,867 [3948] DEBUG Servicesys_permission - 获取动态列表
2020-01-02 20:56:41,867 [3948] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='super' and B.PermissionCode = A.PermissionCode 
2020-01-02 20:56:42,071 [10084] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'super'
2020-01-02 20:56:49,329 [9344] DEBUG Servicesys_role - 修改角色菜单权限
2020-01-02 20:56:49,334 [9344] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'super'
2020-01-02 20:56:49,352 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10')
2020-01-02 20:56:49,353 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1019')
2020-01-02 20:56:49,353 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1002')
2020-01-02 20:56:49,354 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1001')
2020-01-02 20:56:49,355 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1009')
2020-01-02 20:56:49,356 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1010')
2020-01-02 20:56:49,357 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1013')
2020-01-02 20:56:49,357 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1007')
2020-01-02 20:56:49,358 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1006')
2020-01-02 20:56:49,359 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1011')
2020-01-02 20:56:49,360 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1003')
2020-01-02 20:56:49,361 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1012')
2020-01-02 20:56:49,362 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1008')
2020-01-02 20:56:49,362 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1005')
2020-01-02 20:56:49,363 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1004')
2020-01-02 20:56:49,364 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0101')
2020-01-02 20:56:49,365 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100101')
2020-01-02 20:56:49,366 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100201')
2020-01-02 20:56:49,367 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100312')
2020-01-02 20:56:49,367 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100401')
2020-01-02 20:56:49,368 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100501')
2020-01-02 20:56:49,369 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100601')
2020-01-02 20:56:49,370 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100701')
2020-01-02 20:56:49,371 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100801')
2020-01-02 20:56:49,372 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100901')
2020-01-02 20:56:49,375 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101001')
2020-01-02 20:56:49,376 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101101')
2020-01-02 20:56:49,376 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101201')
2020-01-02 20:56:49,377 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101301')
2020-01-02 20:56:49,378 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','11')
2020-01-02 20:56:49,379 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1105')
2020-01-02 20:56:49,380 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1101')
2020-01-02 20:56:49,381 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1102')
2020-01-02 20:56:49,382 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1103')
2020-01-02 20:56:49,382 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1104')
2020-01-02 20:56:49,383 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1109')
2020-01-02 20:56:49,384 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','03')
2020-01-02 20:56:49,385 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0301')
2020-01-02 20:56:49,386 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0302')
2020-01-02 20:56:49,387 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0303')
2020-01-02 20:56:49,388 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0304')
2020-01-02 20:56:49,389 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','12')
2020-01-02 20:56:49,390 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1204')
2020-01-02 20:56:49,391 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1201')
2020-01-02 20:56:49,391 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1202')
2020-01-02 20:56:49,392 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1203')
2020-01-02 20:56:49,393 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','99')
2020-01-02 20:56:49,394 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9902')
2020-01-02 20:56:49,395 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9903')
2020-01-02 20:56:49,395 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9910')
2020-01-02 20:56:49,396 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9904')
2020-01-02 20:56:49,398 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9905')
2020-01-02 20:56:49,398 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9906')
2020-01-02 20:56:49,399 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9911')
2020-01-02 20:56:49,400 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9907')
2020-01-02 20:56:49,401 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','98')
2020-01-02 20:56:49,402 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9810')
2020-01-02 20:56:49,402 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9915')
2020-01-02 20:56:49,403 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9920')
2020-01-02 20:56:49,404 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9950')
2020-01-02 20:56:49,405 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9960')
2020-01-02 20:56:49,406 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9961')
2020-01-02 20:56:49,406 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10000')
2020-01-02 20:56:49,407 [9344] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10001')
2020-01-02 20:56:49,409 [9344] DEBUG Servicesys_role - 修改角色菜单按钮权限
2020-01-02 20:56:49,409 [9344] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'super'
2020-01-02 20:56:49,410 [9344] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','add')
2020-01-02 20:56:49,411 [9344] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','edit')
2020-01-02 20:56:49,412 [9344] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','delete')
2020-01-02 20:56:49,414 [9344] DEBUG Servicesys_role - 修改角色数据权限
2020-01-02 20:56:49,414 [9344] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'super'
2020-01-02 20:56:49,415 [9344] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('super','0102','0')
2020-01-02 20:56:49,417 [9344] DEBUG Servicesys_role - 修改角色数据列权限
2020-01-02 20:56:49,417 [9344] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'super'
2020-01-02 20:56:49,418 [9344] DEBUG Sys - insert into sys_roleMenuColumnMap([RoleCode],[MenuCode],[IsReject],[FieldName]) values('super','1001','True','BillNo')
2020-01-02 20:56:56,213 [10084] DEBUG Sys - select * from sys_button order by ButtonSeq
2020-01-02 20:56:56,216 [10084] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R3' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R3'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R3'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R3'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R3'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R3'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R3'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R3'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R3'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R3'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R3'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R3'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R3'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R3'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R3'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2020-01-02 20:56:56,298 [10936] DEBUG Servicesys_permission - 获取动态列表
2020-01-02 20:56:56,299 [10936] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R3' and B.PermissionCode = A.PermissionCode 
2020-01-02 20:56:56,518 [10084] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R3'
2020-01-02 20:57:15,495 [10936] DEBUG Servicesys_role - 修改角色菜单权限
2020-01-02 20:57:15,505 [10936] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'R3'
2020-01-02 20:57:15,525 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','10')
2020-01-02 20:57:15,531 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1002')
2020-01-02 20:57:15,536 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1001')
2020-01-02 20:57:15,537 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1009')
2020-01-02 20:57:15,537 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1010')
2020-01-02 20:57:15,538 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1013')
2020-01-02 20:57:15,539 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1007')
2020-01-02 20:57:15,540 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1006')
2020-01-02 20:57:15,541 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1011')
2020-01-02 20:57:15,542 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1003')
2020-01-02 20:57:15,543 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1012')
2020-01-02 20:57:15,543 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1008')
2020-01-02 20:57:15,544 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1005')
2020-01-02 20:57:15,545 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1004')
2020-01-02 20:57:15,546 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','0101')
2020-01-02 20:57:15,547 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','100101')
2020-01-02 20:57:15,551 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','100201')
2020-01-02 20:57:15,552 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','100312')
2020-01-02 20:57:15,553 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','100401')
2020-01-02 20:57:15,554 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','100501')
2020-01-02 20:57:15,554 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','100601')
2020-01-02 20:57:15,555 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','100701')
2020-01-02 20:57:15,556 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','100801')
2020-01-02 20:57:15,557 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','100901')
2020-01-02 20:57:15,558 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','101001')
2020-01-02 20:57:15,558 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','101101')
2020-01-02 20:57:15,559 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','101201')
2020-01-02 20:57:15,560 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','101301')
2020-01-02 20:57:15,561 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','11')
2020-01-02 20:57:15,562 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1105')
2020-01-02 20:57:15,563 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1101')
2020-01-02 20:57:15,563 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1102')
2020-01-02 20:57:15,564 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1103')
2020-01-02 20:57:15,565 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1104')
2020-01-02 20:57:15,566 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1109')
2020-01-02 20:57:15,567 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','03')
2020-01-02 20:57:15,567 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','0301')
2020-01-02 20:57:15,568 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','0302')
2020-01-02 20:57:15,569 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','0303')
2020-01-02 20:57:15,570 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','0304')
2020-01-02 20:57:15,571 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','12')
2020-01-02 20:57:15,571 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1204')
2020-01-02 20:57:15,572 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1201')
2020-01-02 20:57:15,573 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1202')
2020-01-02 20:57:15,574 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','1203')
2020-01-02 20:57:15,575 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','99')
2020-01-02 20:57:15,575 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9902')
2020-01-02 20:57:15,576 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9903')
2020-01-02 20:57:15,577 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9910')
2020-01-02 20:57:15,578 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9904')
2020-01-02 20:57:15,579 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9905')
2020-01-02 20:57:15,579 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9906')
2020-01-02 20:57:15,580 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9911')
2020-01-02 20:57:15,581 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9907')
2020-01-02 20:57:15,582 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','98')
2020-01-02 20:57:15,583 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9810')
2020-01-02 20:57:15,584 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9915')
2020-01-02 20:57:15,584 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9920')
2020-01-02 20:57:15,585 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9950')
2020-01-02 20:57:15,586 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9960')
2020-01-02 20:57:15,587 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','9961')
2020-01-02 20:57:15,588 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','10000')
2020-01-02 20:57:15,592 [10936] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R3','10001')
2020-01-02 20:57:15,594 [10936] DEBUG Servicesys_role - 修改角色菜单按钮权限
2020-01-02 20:57:15,594 [10936] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'R3'
2020-01-02 20:57:15,598 [10936] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','10001','add')
2020-01-02 20:57:15,603 [10936] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','10001','edit')
2020-01-02 20:57:15,611 [10936] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','10001','delete')
2020-01-02 20:57:15,617 [10936] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','10001','refresh')
2020-01-02 20:57:15,623 [10936] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R3','10001','save')
2020-01-02 20:57:15,625 [10936] DEBUG Servicesys_role - 修改角色数据权限
2020-01-02 20:57:15,625 [10936] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'R3'
2020-01-02 20:57:15,629 [10936] DEBUG Servicesys_role - 修改角色数据列权限
2020-01-02 20:57:15,630 [10936] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'R3'
2020-01-02 20:57:18,462 [11148] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2020-01-02 20:57:18,775 [9344] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-02 20:57:19,466 [10936] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/role/Index','/Sys/role')
2020-01-02 20:57:19,471 [10936] DEBUG Servicesys_user - 获取动态列表
2020-01-02 20:57:19,471 [10936] DEBUG Sys - select UserCode,UserName from sys_user
2020-01-02 20:57:19,472 [10936] DEBUG Servicesys_organize - 获取动态列表
2020-01-02 20:57:19,472 [10936] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2020-01-02 20:57:20,158 [8488] DEBUG Servicesys_role - 获取实体列表
2020-01-02 20:57:20,158 [8488] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2020-01-02 20:57:54,064 [9344] DEBUG Servicesys_user - 获取实体对象
2020-01-02 20:57:54,064 [9344] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  '1234'and IsEnable =  'True'
2020-01-02 20:57:54,066 [9344] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'admin' 
2020-01-02 20:57:54,071 [9344] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('admin','管理员','4S6DBKLDWJUEQVW','localhost','上海市','2020/1/2 20:57:54')
2020-01-02 20:57:54,072 [9344] DEBUG Servicemms_project - 获取实体对象
2020-01-02 20:57:54,072 [9344] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2020-01-02 20:57:54,128 [3948] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2020-01-02 20:57:54,443 [6428] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-02 20:58:02,283 [7160] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/role/Index','/Sys/role')
2020-01-02 20:58:02,286 [7160] DEBUG Servicesys_user - 获取动态列表
2020-01-02 20:58:02,286 [7160] DEBUG Sys - select UserCode,UserName from sys_user
2020-01-02 20:58:02,288 [7160] DEBUG Servicesys_organize - 获取动态列表
2020-01-02 20:58:02,288 [7160] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2020-01-02 20:58:02,727 [9344] DEBUG Servicesys_role - 获取实体列表
2020-01-02 20:58:02,728 [9344] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2020-01-02 20:58:18,712 [11148] DEBUG Sys - select * from sys_button order by ButtonSeq
2020-01-02 20:58:18,715 [11148] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='super' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='super'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='super'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='super'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='super'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='super'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='super'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='super'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='super'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='super'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='super'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='super'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='super'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='super'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='super'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2020-01-02 20:58:18,799 [3948] DEBUG Servicesys_permission - 获取动态列表
2020-01-02 20:58:18,799 [3948] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='super' and B.PermissionCode = A.PermissionCode 
2020-01-02 20:58:18,829 [11148] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'super'
2020-01-02 20:58:44,027 [6428] DEBUG Servicesys_role - 修改角色菜单权限
2020-01-02 20:58:44,056 [6428] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'super'
2020-01-02 20:58:44,060 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10')
2020-01-02 20:58:44,061 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1019')
2020-01-02 20:58:44,062 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1002')
2020-01-02 20:58:44,062 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1001')
2020-01-02 20:58:44,063 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1009')
2020-01-02 20:58:44,064 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1010')
2020-01-02 20:58:44,065 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1013')
2020-01-02 20:58:44,066 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1007')
2020-01-02 20:58:44,067 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1006')
2020-01-02 20:58:44,067 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1011')
2020-01-02 20:58:44,068 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1003')
2020-01-02 20:58:44,069 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1012')
2020-01-02 20:58:44,070 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1008')
2020-01-02 20:58:44,071 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1005')
2020-01-02 20:58:44,071 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1004')
2020-01-02 20:58:44,072 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0101')
2020-01-02 20:58:44,073 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100101')
2020-01-02 20:58:44,074 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100201')
2020-01-02 20:58:44,075 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100312')
2020-01-02 20:58:44,076 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100401')
2020-01-02 20:58:44,076 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100501')
2020-01-02 20:58:44,077 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100601')
2020-01-02 20:58:44,078 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100701')
2020-01-02 20:58:44,079 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100801')
2020-01-02 20:58:44,080 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100901')
2020-01-02 20:58:44,080 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101001')
2020-01-02 20:58:44,081 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101101')
2020-01-02 20:58:44,082 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101201')
2020-01-02 20:58:44,083 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101301')
2020-01-02 20:58:44,086 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','11')
2020-01-02 20:58:44,087 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1105')
2020-01-02 20:58:44,088 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1101')
2020-01-02 20:58:44,089 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1102')
2020-01-02 20:58:44,090 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1103')
2020-01-02 20:58:44,091 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1104')
2020-01-02 20:58:44,092 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1109')
2020-01-02 20:58:44,092 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','03')
2020-01-02 20:58:44,093 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0301')
2020-01-02 20:58:44,094 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0302')
2020-01-02 20:58:44,095 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0303')
2020-01-02 20:58:44,096 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0304')
2020-01-02 20:58:44,097 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','12')
2020-01-02 20:58:44,097 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1204')
2020-01-02 20:58:44,098 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1201')
2020-01-02 20:58:44,099 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1202')
2020-01-02 20:58:44,100 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1203')
2020-01-02 20:58:44,101 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','99')
2020-01-02 20:58:44,101 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9902')
2020-01-02 20:58:44,102 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9903')
2020-01-02 20:58:44,103 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9910')
2020-01-02 20:58:44,104 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9904')
2020-01-02 20:58:44,105 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9905')
2020-01-02 20:58:44,105 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9906')
2020-01-02 20:58:44,106 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9911')
2020-01-02 20:58:44,107 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9907')
2020-01-02 20:58:44,107 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','98')
2020-01-02 20:58:44,108 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9810')
2020-01-02 20:58:44,109 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9915')
2020-01-02 20:58:44,110 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9920')
2020-01-02 20:58:44,111 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9950')
2020-01-02 20:58:44,112 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9960')
2020-01-02 20:58:44,112 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9961')
2020-01-02 20:58:44,113 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10000')
2020-01-02 20:58:44,114 [6428] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10001')
2020-01-02 20:58:44,116 [6428] DEBUG Servicesys_role - 修改角色菜单按钮权限
2020-01-02 20:58:44,116 [6428] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'super'
2020-01-02 20:58:44,117 [6428] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','add')
2020-01-02 20:58:44,118 [6428] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','edit')
2020-01-02 20:58:44,119 [6428] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','delete')
2020-01-02 20:58:44,121 [6428] DEBUG Servicesys_role - 修改角色数据权限
2020-01-02 20:58:44,121 [6428] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'super'
2020-01-02 20:58:44,123 [6428] DEBUG Servicesys_role - 修改角色数据列权限
2020-01-02 20:58:44,125 [6428] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'super'
2020-01-02 20:58:44,126 [6428] DEBUG Sys - insert into sys_roleMenuColumnMap([RoleCode],[MenuCode],[IsReject],[FieldName]) values('super','1001','True','BillNo')
2020-01-02 20:58:46,258 [6032] DEBUG Sys - select * from sys_button order by ButtonSeq
2020-01-02 20:58:46,261 [6032] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='super' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='super'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='super'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='super'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='super'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='super'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='super'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='super'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='super'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='super'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='super'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='super'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='super'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='super'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='super'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2020-01-02 20:58:46,333 [3948] DEBUG Servicesys_permission - 获取动态列表
2020-01-02 20:58:46,333 [3948] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='super' and B.PermissionCode = A.PermissionCode 
2020-01-02 20:58:46,376 [6032] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'super'
2020-01-02 20:58:53,649 [6032] DEBUG Sys - 
 select A1.UserName as MemberName ,A1.UserCode as MemberCode,'user' as MemberType
  from sys_user A1
 where A1.UserCode in (select B1.UserCode from sys_userRoleMap B1 where B1.RoleCode = 'R3')
union
 select A2.OrganizeName as MemberName ,A2.OrganizeCode as MemberCode,'organize' as MemberType
   from sys_organize A2
  where A2.OrganizeCode in (select B2.OrganizeCode from sys_organizeRoleMap B2 where B2.RoleCode = 'R3')
2020-01-02 20:59:03,408 [3948] DEBUG Sys - 
 select A1.UserName as MemberName ,A1.UserCode as MemberCode,'user' as MemberType
  from sys_user A1
 where A1.UserCode in (select B1.UserCode from sys_userRoleMap B1 where B1.RoleCode = 'super')
union
 select A2.OrganizeName as MemberName ,A2.OrganizeCode as MemberCode,'organize' as MemberType
   from sys_organize A2
  where A2.OrganizeCode in (select B2.OrganizeCode from sys_organizeRoleMap B2 where B2.RoleCode = 'super')
2020-01-02 20:59:15,308 [6428] DEBUG Sys - 
 select A1.UserName as MemberName ,A1.UserCode as MemberCode,'user' as MemberType
  from sys_user A1
 where A1.UserCode in (select B1.UserCode from sys_userRoleMap B1 where B1.RoleCode = 'R3')
union
 select A2.OrganizeName as MemberName ,A2.OrganizeCode as MemberCode,'organize' as MemberType
   from sys_organize A2
  where A2.OrganizeCode in (select B2.OrganizeCode from sys_organizeRoleMap B2 where B2.RoleCode = 'R3')
2020-01-02 20:59:29,603 [6032] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/user/Index','/Sys/user')
2020-01-02 20:59:31,361 [7840] DEBUG Servicesys_organize - 获取实体列表
2020-01-02 20:59:31,361 [7840] DEBUG Sys - select sys_organize.* from sys_organize
2020-01-02 20:59:31,685 [10336] DEBUG Servicesys_user - 获取实体列表
2020-01-02 20:59:31,686 [10336] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2020-01-02 20:59:31,718 [10336] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2020-01-02 21:00:00,818 [8488] DEBUG Servicesys_user - 编辑记录
2020-01-02 21:00:00,819 [8488] DEBUG Servicesys_user - 获取动态对象
2020-01-02 21:00:00,827 [8488] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'zhupan'
2020-01-02 21:00:00,847 [8488] DEBUG Sys - insert into sys_user([UserCode],[UserName],[Description],[IsEnable],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('zhupan','祝盼','管理员','true','管理员','2020/1/2 21:00:00','管理员','2020/1/2 21:00:00')
2020-01-02 21:00:00,857 [8488] DEBUG Sys - update sys_user set [Password] = '1234' where [UserCode] = 'zhupan'
2020-01-02 21:00:19,476 [3948] DEBUG Sys - update sys_user set [Password] = '1234' where [UserCode] = 'zhupan'
2020-01-02 21:00:35,685 [8488] DEBUG Servicesys_user - 获取实体列表
2020-01-02 21:00:35,685 [8488] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','04'))) order by UserSeq
2020-01-02 21:00:35,802 [8488] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','04'))) ) tb_temp
2020-01-02 21:00:49,046 [10084] DEBUG Servicesys_user - 获取实体列表
2020-01-02 21:00:49,047 [10084] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','04'))) order by UserSeq
2020-01-02 21:00:49,059 [10084] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','04'))) ) tb_temp
2020-01-02 21:00:58,967 [10336] DEBUG Servicesys_user - 获取实体列表
2020-01-02 21:00:58,968 [10336] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0402'))) order by UserSeq
2020-01-02 21:00:59,021 [10336] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0402'))) ) tb_temp
2020-01-02 21:00:59,852 [7840] DEBUG Servicesys_user - 获取实体列表
2020-01-02 21:00:59,852 [7840] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0401'))) order by UserSeq
2020-01-02 21:00:59,908 [7840] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0401'))) ) tb_temp
2020-01-02 21:01:01,643 [6032] DEBUG Servicesys_user - 获取实体列表
2020-01-02 21:01:01,643 [6032] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0402'))) order by UserSeq
2020-01-02 21:01:01,648 [6032] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0402'))) ) tb_temp
2020-01-02 21:01:03,214 [10084] DEBUG Servicesys_user - 获取实体列表
2020-01-02 21:01:03,215 [10084] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0406'))) order by UserSeq
2020-01-02 21:01:03,270 [10084] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0406'))) ) tb_temp
2020-01-02 21:01:05,082 [10336] DEBUG Servicesys_user - 获取实体列表
2020-01-02 21:01:05,083 [10336] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040601'))) order by UserSeq
2020-01-02 21:01:05,142 [10336] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','040601'))) ) tb_temp
2020-01-02 21:01:06,176 [3948] DEBUG Servicesys_user - 获取实体列表
2020-01-02 21:01:06,176 [3948] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0407'))) order by UserSeq
2020-01-02 21:01:06,226 [3948] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0407'))) ) tb_temp
2020-01-02 21:01:07,538 [7160] DEBUG Servicesys_user - 获取实体列表
2020-01-02 21:01:07,538 [7160] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0408'))) order by UserSeq
2020-01-02 21:01:07,599 [7160] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0408'))) ) tb_temp
2020-01-02 21:01:09,323 [11148] DEBUG Servicesys_user - 获取实体列表
2020-01-02 21:01:09,323 [11148] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0409'))) order by UserSeq
2020-01-02 21:01:09,382 [11148] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0409'))) ) tb_temp
2020-01-02 21:01:10,872 [8488] DEBUG Servicesys_user - 获取实体列表
2020-01-02 21:01:10,872 [8488] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0410'))) order by UserSeq
2020-01-02 21:01:10,929 [8488] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','0410'))) ) tb_temp
2020-01-02 21:01:13,590 [3948] DEBUG Servicesys_user - 获取实体列表
2020-01-02 21:01:13,591 [3948] DEBUG Sys - select top 20 sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','04'))) order by UserSeq
2020-01-02 21:01:13,604 [3948] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user where  UserCode in (select UserCode from sys_userOrganizeMap where OrganizeCode in (select ID from [dbo].[GetChild]('sys_organize','04'))) ) tb_temp
2020-01-02 21:02:00,291 [6032] DEBUG Servicesys_user - 获取实体对象
2020-01-02 21:02:00,291 [6032] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2020-01-02 21:02:00,294 [6032] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2020-01-02 21:02:00,299 [6032] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','4S6DBKLDWJUEQVW','localhost','上海市','2020/1/2 21:02:00')
2020-01-02 21:02:00,303 [6032] DEBUG Servicemms_project - 获取实体对象
2020-01-02 21:02:00,303 [6032] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2020-01-02 21:02:00,358 [10084] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-02 21:02:00,670 [7840] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-02 21:02:05,910 [10084] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/generator/Index','/Sys/generator')
2020-01-02 21:02:19,616 [10084] DEBUG Erp - SELECT Name as TableName FROM sys.tables order by Name
2020-01-02 21:02:19,643 [7160] DEBUG Erp - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('undefined')
ORDER BY sys.columns.column_id
2020-01-02 21:02:22,504 [10336] DEBUG Erp - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('base_material')
ORDER BY sys.columns.column_id
2020-01-02 21:03:37,748 [3948] DEBUG Erp - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('base_material')
ORDER BY sys.columns.column_id
2020-01-02 21:03:37,803 [5392] DEBUG Erp - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('base_material')
ORDER BY sys.columns.column_id
2020-01-02 21:03:54,787 [8488] DEBUG Erp - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('base_material')
ORDER BY sys.columns.column_id
2020-01-02 21:03:54,831 [5392] DEBUG Erp - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('base_material')
ORDER BY sys.columns.column_id
2020-01-02 21:04:01,891 [7160] DEBUG Erp - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('base_material')
ORDER BY sys.columns.column_id
2020-01-02 21:04:01,929 [10084] DEBUG Erp - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('base_material')
ORDER BY sys.columns.column_id
2020-01-02 21:04:31,613 [10336] DEBUG Erp - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('base_material')
ORDER BY sys.columns.column_id
2020-01-02 21:04:31,622 [10336] DEBUG Erp - sp_pkeys 'base_material'
2020-01-02 21:05:41,438 [7008] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/material/Index','/Erp/material')
2020-01-02 21:06:11,287 [10084] DEBUG Erp - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('base_data')
ORDER BY sys.columns.column_id
2020-01-02 21:06:13,003 [10464] DEBUG Erp - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('base_area')
ORDER BY sys.columns.column_id
2020-01-02 21:06:14,614 [10972] DEBUG Erp - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('base_location')
ORDER BY sys.columns.column_id
2020-01-02 21:06:15,734 [7008] DEBUG Erp - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('base_parts')
ORDER BY sys.columns.column_id
2020-01-02 21:06:16,510 [7160] DEBUG Erp - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('base_material')
ORDER BY sys.columns.column_id
2020-01-02 21:06:17,236 [10464] DEBUG Erp - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('base_location')
ORDER BY sys.columns.column_id
2020-01-02 21:06:17,759 [11148] DEBUG Erp - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('base_data')
ORDER BY sys.columns.column_id
2020-01-02 21:06:18,208 [3948] DEBUG Erp - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('base_customer')
ORDER BY sys.columns.column_id
2020-01-02 21:06:18,656 [7160] DEBUG Erp - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('base_area')
ORDER BY sys.columns.column_id
2020-01-02 21:06:21,096 [8488] DEBUG Erp - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('base_parts')
ORDER BY sys.columns.column_id
2020-01-02 21:07:01,673 [10084] DEBUG Erp - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('base_material')
ORDER BY sys.columns.column_id
2020-01-02 21:07:12,472 [10464] DEBUG Erp - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('base_material')
ORDER BY sys.columns.column_id
2020-01-02 21:07:12,500 [3948] DEBUG Erp - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('base_material')
ORDER BY sys.columns.column_id
2020-01-02 21:09:36,853 [9576] DEBUG Erp - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('base_material')
ORDER BY sys.columns.column_id
2020-01-02 21:09:36,870 [9576] DEBUG Erp - sp_pkeys 'base_material'
2020-01-02 21:14:42,729 [7160] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/material/Index','/Erp/material')
2020-01-02 21:14:44,064 [3948] DEBUG Servicebase_material - 获取实体列表
2020-01-02 21:14:44,070 [3948] DEBUG Erp - select top 20 base_material.* from base_material order by MaterialCode
2020-01-02 21:14:44,075 [3948] ERROR Servicebase_material - 获取实体列表失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'MaterialCode' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QueryMany[TEntity,TList](Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 14
   在 Zephyr.Data.DbCommand.QueryMany[TEntity](Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 36
   在 Zephyr.Data.SelectBuilder`1.QueryMany(Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Builders\Select\SelectBuilder.cs:行号 99
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass42_0.<GetModelList>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 21
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:52cbdacc-8d94-4a9c-9918-e9b79cbbc229
Error Number:207,State:1,Class:16
2020-01-02 21:14:44,092 [3948] ERROR /api/erp/material - System.Data.SqlClient.SqlException (0x80131904): 列名 'MaterialCode' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetModelList(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 21
   在 Zephyr.Core.ServiceBase`1.GetModelListWithPaging(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 35
   在 ERP.Web.Areas.Erp.Controllers.MaterialApiController.Get(RequestWrapper request) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Controllers\MaterialController.cs:行号 34
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:52cbdacc-8d94-4a9c-9918-e9b79cbbc229
Error Number:207,State:1,Class:16
2020-01-02 21:15:11,015 [10336] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/material/Index','/Erp/material')
2020-01-02 21:15:11,498 [892] DEBUG Servicebase_material - 获取实体列表
2020-01-02 21:15:11,498 [892] DEBUG Erp - select top 20 base_material.* from base_material order by MaterialCode
2020-01-02 21:15:11,500 [892] ERROR Servicebase_material - 获取实体列表失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'MaterialCode' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QueryMany[TEntity,TList](Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 14
   在 Zephyr.Data.DbCommand.QueryMany[TEntity](Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 36
   在 Zephyr.Data.SelectBuilder`1.QueryMany(Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Builders\Select\SelectBuilder.cs:行号 99
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass42_0.<GetModelList>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 21
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:52cbdacc-8d94-4a9c-9918-e9b79cbbc229
Error Number:207,State:1,Class:16
2020-01-02 21:15:11,512 [892] ERROR /api/erp/material - System.Data.SqlClient.SqlException (0x80131904): 列名 'MaterialCode' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetModelList(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 21
   在 Zephyr.Core.ServiceBase`1.GetModelListWithPaging(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 35
   在 ERP.Web.Areas.Erp.Controllers.MaterialApiController.Get(RequestWrapper request) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Controllers\MaterialController.cs:行号 34
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:52cbdacc-8d94-4a9c-9918-e9b79cbbc229
Error Number:207,State:1,Class:16
2020-01-02 21:15:15,214 [3856] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/material/Index','/Erp/material')
2020-01-02 21:15:15,729 [7008] DEBUG Servicebase_material - 获取实体列表
2020-01-02 21:15:15,730 [7008] DEBUG Erp - select top 20 base_material.* from base_material order by MaterialCode
2020-01-02 21:15:15,732 [7008] ERROR Servicebase_material - 获取实体列表失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'MaterialCode' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QueryMany[TEntity,TList](Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 14
   在 Zephyr.Data.DbCommand.QueryMany[TEntity](Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 36
   在 Zephyr.Data.SelectBuilder`1.QueryMany(Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Builders\Select\SelectBuilder.cs:行号 99
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass42_0.<GetModelList>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 21
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:52cbdacc-8d94-4a9c-9918-e9b79cbbc229
Error Number:207,State:1,Class:16
2020-01-02 21:15:15,766 [7008] ERROR /api/erp/material - System.Data.SqlClient.SqlException (0x80131904): 列名 'MaterialCode' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetModelList(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 21
   在 Zephyr.Core.ServiceBase`1.GetModelListWithPaging(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 35
   在 ERP.Web.Areas.Erp.Controllers.MaterialApiController.Get(RequestWrapper request) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Controllers\MaterialController.cs:行号 34
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:52cbdacc-8d94-4a9c-9918-e9b79cbbc229
Error Number:207,State:1,Class:16
2020-01-02 21:16:03,206 [10336] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/material/Index','/Erp/material')
2020-01-02 21:16:03,764 [10084] DEBUG Servicebase_material - 获取实体列表
2020-01-02 21:16:03,765 [10084] DEBUG Erp - select top 20 base_material.* from base_material order by MaterialCode
2020-01-02 21:16:03,766 [10084] ERROR Servicebase_material - 获取实体列表失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'MaterialCode' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QueryMany[TEntity,TList](Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 14
   在 Zephyr.Data.DbCommand.QueryMany[TEntity](Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 36
   在 Zephyr.Data.SelectBuilder`1.QueryMany(Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Builders\Select\SelectBuilder.cs:行号 99
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass42_0.<GetModelList>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 21
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:52cbdacc-8d94-4a9c-9918-e9b79cbbc229
Error Number:207,State:1,Class:16
2020-01-02 21:16:03,784 [10084] ERROR /api/erp/material - System.Data.SqlClient.SqlException (0x80131904): 列名 'MaterialCode' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetModelList(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 21
   在 Zephyr.Core.ServiceBase`1.GetModelListWithPaging(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 35
   在 ERP.Web.Areas.Erp.Controllers.MaterialApiController.Get(RequestWrapper request) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Controllers\MaterialController.cs:行号 34
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:52cbdacc-8d94-4a9c-9918-e9b79cbbc229
Error Number:207,State:1,Class:16
2020-01-02 21:16:17,725 [10336] DEBUG Servicebase_material - 获取实体列表
2020-01-02 21:16:17,725 [10336] DEBUG Erp - select top 20 base_material.* from base_material order by type asc
2020-01-02 21:16:17,753 [10336] DEBUG Erp - select count(*) from ( select base_material.* from base_material ) tb_temp
2020-01-02 21:16:18,842 [7160] DEBUG Servicebase_material - 获取实体列表
2020-01-02 21:16:18,842 [7160] DEBUG Erp - select top 20 base_material.* from base_material order by type desc
2020-01-02 21:16:18,845 [7160] DEBUG Erp - select count(*) from ( select base_material.* from base_material ) tb_temp
2020-01-02 21:16:19,703 [892] DEBUG Servicebase_material - 获取实体列表
2020-01-02 21:16:19,703 [892] DEBUG Erp - select top 20 base_material.* from base_material order by name asc
2020-01-02 21:16:19,718 [892] DEBUG Erp - select count(*) from ( select base_material.* from base_material ) tb_temp
2020-01-02 21:17:23,515 [8696] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/material/Index','/Erp/material')
2020-01-02 21:19:52,192 [1884] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/material/Index','/Mms/material')
2020-01-02 21:19:54,250 [10336] DEBUG Servicemms_materialType - 获取动态列表
2020-01-02 21:19:54,255 [11160] DEBUG Servicemms_material - 获取实体列表
2020-01-02 21:19:54,265 [10336] DEBUG Mms - select mms_materialType.* from mms_materialType order by MaterialType
2020-01-02 21:19:54,298 [11160] DEBUG Mms - select top 20 mms_material.* from mms_material order by MaterialCode
2020-01-02 21:19:54,323 [11160] DEBUG Mms - select count(*) from ( select mms_material.* from mms_material ) tb_temp
2020-01-02 21:19:58,174 [9784] DEBUG Servicemms_material - 获取实体列表
2020-01-02 21:19:58,174 [9784] DEBUG Mms - select top 20 mms_material.* from mms_material where  MaterialType =  '010101' order by MaterialCode
2020-01-02 21:19:58,179 [9784] DEBUG Mms - select count(*) from ( select mms_material.* from mms_material where  MaterialType =  '010101' ) tb_temp
2020-01-02 21:19:59,300 [10024] DEBUG Mms - select max(MaterialCode) 
from mms_material 
where MaterialType='010101'
2020-01-02 21:20:12,361 [7008] DEBUG Mms - select max(MaterialCode) 
from mms_material 
where MaterialType='010101'
2020-01-02 21:20:13,617 [5952] DEBUG Mms - select max(MaterialCode) 
from mms_material 
where MaterialType='010101'
2020-01-02 21:20:15,142 [10952] DEBUG Mms - select max(MaterialCode) 
from mms_material 
where MaterialType='010101'
2020-01-02 21:21:05,127 [10088] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/material/Index','/Erp/material')
2020-01-02 21:21:06,717 [11160] DEBUG Servicebase_material - 获取实体列表
2020-01-02 21:21:06,725 [11160] DEBUG Erp - select top 20 base_material.* from base_material order by MaterialCode
2020-01-02 21:21:06,727 [11160] ERROR Servicebase_material - 获取实体列表失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'MaterialCode' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QueryMany[TEntity,TList](Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 14
   在 Zephyr.Data.DbCommand.QueryMany[TEntity](Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 36
   在 Zephyr.Data.SelectBuilder`1.QueryMany(Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Builders\Select\SelectBuilder.cs:行号 99
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass42_0.<GetModelList>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 21
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:0ca7f8b9-3b7c-4dbf-b5f7-759d98d2c8b3
Error Number:207,State:1,Class:16
2020-01-02 21:21:06,752 [11160] ERROR /api/erp/material - System.Data.SqlClient.SqlException (0x80131904): 列名 'MaterialCode' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetModelList(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 21
   在 Zephyr.Core.ServiceBase`1.GetModelListWithPaging(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 35
   在 ERP.Web.Areas.Erp.Controllers.MaterialApiController.Get(RequestWrapper request) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Controllers\MaterialController.cs:行号 34
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:0ca7f8b9-3b7c-4dbf-b5f7-759d98d2c8b3
Error Number:207,State:1,Class:16
2020-01-02 21:21:29,102 [9784] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/material/Index','/Erp/material')
2020-01-02 21:21:31,038 [5952] DEBUG Servicebase_material - 获取实体列表
2020-01-02 21:21:31,038 [5952] DEBUG Erp - select top 20 base_material.* from base_material order by MaterialCode
2020-01-02 21:21:31,069 [5952] ERROR Servicebase_material - 获取实体列表失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'MaterialCode' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QueryMany[TEntity,TList](Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 14
   在 Zephyr.Data.DbCommand.QueryMany[TEntity](Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 36
   在 Zephyr.Data.SelectBuilder`1.QueryMany(Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Builders\Select\SelectBuilder.cs:行号 99
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass42_0.<GetModelList>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 21
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:0ca7f8b9-3b7c-4dbf-b5f7-759d98d2c8b3
Error Number:207,State:1,Class:16
2020-01-02 21:21:31,089 [5952] ERROR /api/erp/material - System.Data.SqlClient.SqlException (0x80131904): 列名 'MaterialCode' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetModelList(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 21
   在 Zephyr.Core.ServiceBase`1.GetModelListWithPaging(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 35
   在 ERP.Web.Areas.Erp.Controllers.MaterialApiController.Get(RequestWrapper request) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Controllers\MaterialController.cs:行号 34
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:0ca7f8b9-3b7c-4dbf-b5f7-759d98d2c8b3
Error Number:207,State:1,Class:16
2020-01-02 21:21:41,605 [11160] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/material/Index','/Erp/material')
2020-01-02 21:21:42,171 [10084] DEBUG Servicebase_material - 获取实体列表
2020-01-02 21:21:42,171 [10084] DEBUG Erp - select top 20 base_material.* from base_material order by MaterialCode
2020-01-02 21:21:42,176 [10084] ERROR Servicebase_material - 获取实体列表失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'MaterialCode' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QueryMany[TEntity,TList](Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 14
   在 Zephyr.Data.DbCommand.QueryMany[TEntity](Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 36
   在 Zephyr.Data.SelectBuilder`1.QueryMany(Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Builders\Select\SelectBuilder.cs:行号 99
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass42_0.<GetModelList>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 21
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:0ca7f8b9-3b7c-4dbf-b5f7-759d98d2c8b3
Error Number:207,State:1,Class:16
2020-01-02 21:21:42,187 [10084] ERROR /api/erp/material - System.Data.SqlClient.SqlException (0x80131904): 列名 'MaterialCode' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetModelList(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 21
   在 Zephyr.Core.ServiceBase`1.GetModelListWithPaging(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 35
   在 ERP.Web.Areas.Erp.Controllers.MaterialApiController.Get(RequestWrapper request) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Controllers\MaterialController.cs:行号 34
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:0ca7f8b9-3b7c-4dbf-b5f7-759d98d2c8b3
Error Number:207,State:1,Class:16
2020-01-02 21:21:42,772 [10088] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/material/Index','/Erp/material')
2020-01-02 21:21:43,135 [11160] DEBUG Servicebase_material - 获取实体列表
2020-01-02 21:21:43,135 [11160] DEBUG Erp - select top 20 base_material.* from base_material order by MaterialCode
2020-01-02 21:21:43,137 [11160] ERROR Servicebase_material - 获取实体列表失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'MaterialCode' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QueryMany[TEntity,TList](Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 14
   在 Zephyr.Data.DbCommand.QueryMany[TEntity](Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 36
   在 Zephyr.Data.SelectBuilder`1.QueryMany(Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Builders\Select\SelectBuilder.cs:行号 99
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass42_0.<GetModelList>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 21
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:0ca7f8b9-3b7c-4dbf-b5f7-759d98d2c8b3
Error Number:207,State:1,Class:16
2020-01-02 21:21:43,152 [11160] ERROR /api/erp/material - System.Data.SqlClient.SqlException (0x80131904): 列名 'MaterialCode' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetModelList(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 21
   在 Zephyr.Core.ServiceBase`1.GetModelListWithPaging(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 35
   在 ERP.Web.Areas.Erp.Controllers.MaterialApiController.Get(RequestWrapper request) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Controllers\MaterialController.cs:行号 34
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:0ca7f8b9-3b7c-4dbf-b5f7-759d98d2c8b3
Error Number:207,State:1,Class:16
2020-01-02 21:21:43,882 [3724] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/material/Index','/Erp/material')
2020-01-02 21:21:44,221 [10088] DEBUG Servicebase_material - 获取实体列表
2020-01-02 21:21:44,222 [10088] DEBUG Erp - select top 20 base_material.* from base_material order by MaterialCode
2020-01-02 21:21:44,224 [10088] ERROR Servicebase_material - 获取实体列表失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'MaterialCode' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QueryMany[TEntity,TList](Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 14
   在 Zephyr.Data.DbCommand.QueryMany[TEntity](Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 36
   在 Zephyr.Data.SelectBuilder`1.QueryMany(Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Builders\Select\SelectBuilder.cs:行号 99
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass42_0.<GetModelList>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 21
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:0ca7f8b9-3b7c-4dbf-b5f7-759d98d2c8b3
Error Number:207,State:1,Class:16
2020-01-02 21:21:44,248 [10088] ERROR /api/erp/material - System.Data.SqlClient.SqlException (0x80131904): 列名 'MaterialCode' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetModelList(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 21
   在 Zephyr.Core.ServiceBase`1.GetModelListWithPaging(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 35
   在 ERP.Web.Areas.Erp.Controllers.MaterialApiController.Get(RequestWrapper request) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Controllers\MaterialController.cs:行号 34
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:0ca7f8b9-3b7c-4dbf-b5f7-759d98d2c8b3
Error Number:207,State:1,Class:16
2020-01-02 21:22:21,596 [9784] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/material/Index','/Erp/material')
2020-01-02 21:22:23,243 [892] DEBUG Servicebase_material - 获取实体列表
2020-01-02 21:22:23,243 [892] DEBUG Erp - select top 20 base_material.* from base_material order by MaterialCode
2020-01-02 21:22:23,247 [892] ERROR Servicebase_material - 获取实体列表失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'MaterialCode' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QueryMany[TEntity,TList](Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 14
   在 Zephyr.Data.DbCommand.QueryMany[TEntity](Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 36
   在 Zephyr.Data.SelectBuilder`1.QueryMany(Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Builders\Select\SelectBuilder.cs:行号 99
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass42_0.<GetModelList>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 21
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:0ca7f8b9-3b7c-4dbf-b5f7-759d98d2c8b3
Error Number:207,State:1,Class:16
2020-01-02 21:22:23,263 [892] ERROR /api/erp/material - System.Data.SqlClient.SqlException (0x80131904): 列名 'MaterialCode' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetModelList(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 21
   在 Zephyr.Core.ServiceBase`1.GetModelListWithPaging(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 35
   在 ERP.Web.Areas.Erp.Controllers.MaterialApiController.Get(RequestWrapper request) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Controllers\MaterialController.cs:行号 34
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:0ca7f8b9-3b7c-4dbf-b5f7-759d98d2c8b3
Error Number:207,State:1,Class:16
2020-01-02 21:22:58,082 [11552] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/material/Index','/Erp/material')
2020-01-02 21:22:59,449 [9784] DEBUG Servicebase_material - 获取实体列表
2020-01-02 21:22:59,450 [9784] DEBUG Erp - select top 20 base_material.* from base_material order by MaterialCode
2020-01-02 21:22:59,454 [9784] ERROR Servicebase_material - 获取实体列表失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'MaterialCode' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QueryMany[TEntity,TList](Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 14
   在 Zephyr.Data.DbCommand.QueryMany[TEntity](Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 36
   在 Zephyr.Data.SelectBuilder`1.QueryMany(Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Builders\Select\SelectBuilder.cs:行号 99
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass42_0.<GetModelList>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 21
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:0ca7f8b9-3b7c-4dbf-b5f7-759d98d2c8b3
Error Number:207,State:1,Class:16
2020-01-02 21:22:59,470 [9784] ERROR /api/erp/material - System.Data.SqlClient.SqlException (0x80131904): 列名 'MaterialCode' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetModelList(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 21
   在 Zephyr.Core.ServiceBase`1.GetModelListWithPaging(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 35
   在 ERP.Web.Areas.Erp.Controllers.MaterialApiController.Get(RequestWrapper request) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Controllers\MaterialController.cs:行号 34
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:0ca7f8b9-3b7c-4dbf-b5f7-759d98d2c8b3
Error Number:207,State:1,Class:16
2020-01-02 21:23:33,219 [10024] DEBUG Servicebase_material - 获取实体列表
2020-01-02 21:23:33,220 [10024] DEBUG Erp - select top 20 base_material.* from base_material order by price asc
2020-01-02 21:23:33,223 [10024] DEBUG Erp - select count(*) from ( select base_material.* from base_material ) tb_temp
2020-01-02 21:23:35,017 [892] DEBUG Servicebase_material - 获取实体列表
2020-01-02 21:23:35,017 [892] DEBUG Erp - select top 20 base_material.* from base_material order by type asc
2020-01-02 21:23:35,018 [892] DEBUG Erp - select count(*) from ( select base_material.* from base_material ) tb_temp
2020-01-02 21:23:35,795 [5840] DEBUG Servicebase_material - 获取实体列表
2020-01-02 21:23:35,796 [5840] DEBUG Erp - select top 20 base_material.* from base_material order by name asc
2020-01-02 21:23:35,797 [5840] DEBUG Erp - select count(*) from ( select base_material.* from base_material ) tb_temp
2020-01-02 21:36:46,893 [2436] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-02 21:36:47,465 [5840] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-02 21:36:48,431 [10128] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/material/Index','/Erp/material')
2020-01-02 21:36:49,621 [6800] DEBUG Servicebase_material - 获取实体列表
2020-01-02 21:36:49,627 [6800] DEBUG Erp - select top 20 base_material.* from base_material order by MaterialCode
2020-01-02 21:36:49,628 [6800] ERROR Servicebase_material - 获取实体列表失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'MaterialCode' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QueryMany[TEntity,TList](Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 14
   在 Zephyr.Data.DbCommand.QueryMany[TEntity](Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 36
   在 Zephyr.Data.SelectBuilder`1.QueryMany(Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Builders\Select\SelectBuilder.cs:行号 99
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass42_0.<GetModelList>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 21
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:f3cf3924-c60d-4484-b8f1-b54a66a6917b
Error Number:207,State:1,Class:16
2020-01-02 21:36:49,635 [6800] ERROR /api/erp/material - System.Data.SqlClient.SqlException (0x80131904): 列名 'MaterialCode' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetModelList(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 21
   在 Zephyr.Core.ServiceBase`1.GetModelListWithPaging(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 35
   在 ERP.Web.Areas.Erp.Controllers.MaterialApiController.Get(RequestWrapper request) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Controllers\MaterialController.cs:行号 34
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:f3cf3924-c60d-4484-b8f1-b54a66a6917b
Error Number:207,State:1,Class:16
2020-01-02 21:37:09,963 [10128] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/material/Index','/Erp/material')
2020-01-02 21:37:10,725 [12244] DEBUG Servicebase_material - 获取实体列表
2020-01-02 21:37:10,726 [12244] DEBUG Erp - select top 20 base_material.* from base_material order by MaterialCode
2020-01-02 21:37:10,729 [12244] ERROR Servicebase_material - 获取实体列表失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'MaterialCode' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QueryMany[TEntity,TList](Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 14
   在 Zephyr.Data.DbCommand.QueryMany[TEntity](Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 36
   在 Zephyr.Data.SelectBuilder`1.QueryMany(Action`2 customMapper) 位置 E:\code\Github\Project\WEBERP\Code\Zephyr.Net\Zephyr.Data\Builders\Select\SelectBuilder.cs:行号 99
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass42_0.<GetModelList>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 21
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:f3cf3924-c60d-4484-b8f1-b54a66a6917b
Error Number:207,State:1,Class:16
2020-01-02 21:37:10,739 [12244] ERROR /api/erp/material - System.Data.SqlClient.SqlException (0x80131904): 列名 'MaterialCode' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetModelList(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 21
   在 Zephyr.Core.ServiceBase`1.GetModelListWithPaging(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 35
   在 ERP.Web.Areas.Erp.Controllers.MaterialApiController.Get(RequestWrapper request) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Controllers\MaterialController.cs:行号 34
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:f3cf3924-c60d-4484-b8f1-b54a66a6917b
Error Number:207,State:1,Class:16
2020-01-02 21:37:25,869 [12244] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2020-01-02 21:37:25,917 [12244] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-02 21:37:25,937 [12244] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-02 21:37:25,940 [12244] DEBUG Servicesys_code - 获取动态列表
2020-01-02 21:37:25,940 [12244] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-02 21:37:28,493 [8464] DEBUG Servicemms_receive - 获取动态列表
2020-01-02 21:37:28,493 [8464] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-02 21:37:28,530 [8464] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-02 21:37:34,333 [12244] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/direct/Index','/Mms/direct')
2020-01-02 21:37:34,347 [12244] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-02 21:37:34,347 [12244] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-02 21:37:34,391 [12244] DEBUG Servicesys_code - 获取动态列表
2020-01-02 21:37:34,391 [12244] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-02 21:37:36,133 [6800] DEBUG Servicemms_direct - 获取动态列表
2020-01-02 21:37:36,134 [6800] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName,D.MerchantsName as SupplierName,E.MerchantsName as PickUnitName
     from 
        mms_direct A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_merchants     D on D.MerchantsCode    = A.SupplierCode
        left join mms_merchants     E on E.MerchantsCode    = A.PickUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-02 21:37:36,171 [6800] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName,D.MerchantsName as SupplierName,E.MerchantsName as PickUnitName
     from 
        mms_direct A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_merchants     D on D.MerchantsCode    = A.SupplierCode
        left join mms_merchants     E on E.MerchantsCode    = A.PickUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-02 21:39:46,405 [7700] DEBUG Servicemms_direct - 获取新主键
2020-01-02 21:39:46,409 [7700] DEBUG Mms - select isnull(max(BillNo),0) from mms_direct
2020-01-02 21:39:46,630 [5520] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/direct/edit')
2020-01-02 21:39:46,654 [5520] DEBUG Servicemms_direct - 获取实体对象
2020-01-02 21:39:46,655 [5520] DEBUG Mms - select mms_direct.* from mms_direct where  BillNo =  '202001020001'
2020-01-02 21:39:46,661 [5520] DEBUG Servicemms_direct - 获取上一条下一条数据
2020-01-02 21:39:46,709 [5520] DEBUG Servicemms_direct - 获取字段
2020-01-02 21:39:46,712 [5520] DEBUG Mms - select top 1 BillNo from mms_direct where  ProjectCode =  '201306030001' order by BillNo
2020-01-02 21:39:46,717 [5520] DEBUG Servicemms_direct - 获取字段
2020-01-02 21:39:46,718 [5520] DEBUG Mms - select top 1 BillNo from mms_direct where  BillNo < '202001020001'and ProjectCode =  '201306030001' order by BillNo desc
2020-01-02 21:39:46,723 [5520] DEBUG Servicemms_direct - 获取字段
2020-01-02 21:39:46,723 [5520] DEBUG Mms - select top 1 BillNo from mms_direct where  BillNo >  '202001020001'and ProjectCode =  '201306030001' order by BillNo
2020-01-02 21:39:46,729 [5520] DEBUG Servicemms_direct - 获取字段
2020-01-02 21:39:46,729 [5520] DEBUG Mms - select top 1 BillNo from mms_direct where  ProjectCode =  '201306030001' order by BillNo desc
2020-01-02 21:39:46,791 [5520] DEBUG Servicesys_code - 获取动态列表
2020-01-02 21:39:46,792 [5520] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2020-01-02 21:39:46,793 [5520] DEBUG Servicesys_code - 获取动态列表
2020-01-02 21:39:46,793 [5520] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-02 21:39:46,794 [5520] DEBUG Servicesys_code - 获取动态列表
2020-01-02 21:39:46,794 [5520] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2020-01-02 21:39:46,795 [5520] DEBUG Servicesys_code - 获取动态列表
2020-01-02 21:39:46,795 [5520] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2020-01-02 21:39:46,798 [5520] DEBUG Servicesys_code - 获取字段
2020-01-02 21:39:46,798 [5520] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-02 21:39:46,802 [5520] DEBUG Servicesys_code - 获取字段
2020-01-02 21:39:46,802 [5520] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-02 21:39:49,689 [5952] DEBUG Servicemms_direct - 获取动态列表
2020-01-02 21:39:49,689 [5952] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_directDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '202001020001' order by A.MaterialCode
2020-01-02 21:40:00,800 [7700] DEBUG Servicemms_materialType - 获取动态列表
2020-01-02 21:40:00,800 [7700] DEBUG Mms - select 
        MaterialTypeName as text,MaterialType as id,ParentCode as pid
     from 
        mms_materialType
     order by MaterialType
2020-01-02 21:40:00,873 [5520] DEBUG Servicemms_material - 获取动态列表
2020-01-02 21:40:00,874 [5520] DEBUG Mms - select top 10 A.* from 
    mms_material A
   order by A.MaterialCode
2020-01-02 21:40:00,889 [5520] DEBUG Mms - select count(*) from ( select A.* from 
    mms_material A
   ) tb_temp
2020-01-02 21:40:03,394 [10128] DEBUG Servicemms_material - 获取动态列表
2020-01-02 21:40:03,395 [10128] DEBUG Mms - select top 10 A.* from 
    mms_material A
   where  MaterialType like '01010103%' order by A.MaterialCode
2020-01-02 21:40:03,400 [10128] DEBUG Mms - select count(*) from ( select A.* from 
    mms_material A
   where  MaterialType like '01010103%' ) tb_temp
2020-01-02 21:40:04,914 [7700] DEBUG Servicemms_material - 获取动态列表
2020-01-02 21:40:04,914 [7700] DEBUG Mms - select top 10 A.* from 
    mms_material A
   where  MaterialType like '01010103%' order by A.MaterialCode
2020-01-02 21:40:04,916 [7700] DEBUG Mms - select count(*) from ( select A.* from 
    mms_material A
   where  MaterialType like '01010103%' ) tb_temp
2020-01-02 21:40:05,148 [5952] DEBUG Servicemms_material - 获取动态列表
2020-01-02 21:40:05,148 [5952] DEBUG Mms - select top 10 A.* from 
    mms_material A
   where  MaterialType like '01010103%' order by A.MaterialCode
2020-01-02 21:40:05,150 [5952] DEBUG Mms - select count(*) from ( select A.* from 
    mms_material A
   where  MaterialType like '01010103%' ) tb_temp
2020-01-02 21:40:13,742 [12180] DEBUG Servicemms_directDetail - 获取新主键
2020-01-02 21:40:13,743 [12180] DEBUG Mms - select isnull(max(RowId),0) from mms_directDetail  where 1 = 1  and  BillNo =  '202001020001'
2020-01-02 21:40:13,748 [12180] DEBUG Mms - select isnull(max(RowId),0) from mms_directDetail  where 1 = 1  and  BillNo =  '202001020001'
2020-01-02 21:40:13,749 [12180] DEBUG Mms - select isnull(max(RowId),0) from mms_directDetail  where 1 = 1  and  BillNo =  '202001020001'
2020-01-02 21:40:38,101 [10088] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/merchant/Index','/Mms/merchant')
2020-01-02 21:40:40,128 [4740] DEBUG Servicemms_merchantsType - 获取动态列表
2020-01-02 21:40:40,129 [4740] DEBUG Mms - select mms_merchantsType.* from mms_merchantsType order by MerchantsTypeCode
2020-01-02 21:40:40,204 [3408] DEBUG Servicemms_merchants - 获取实体列表
2020-01-02 21:40:40,205 [3408] DEBUG Mms - select top 20 mms_merchants.* from mms_merchants order by MerchantsCode
2020-01-02 21:40:40,236 [3408] DEBUG Mms - select count(*) from ( select mms_merchants.* from mms_merchants ) tb_temp
2020-01-02 21:40:42,962 [10088] DEBUG Servicemms_merchants - 获取实体列表
2020-01-02 21:40:42,963 [10088] DEBUG Mms - select top 20 mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '001' order by MerchantsCode
2020-01-02 21:40:42,974 [10088] DEBUG Mms - select count(*) from ( select mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '001' ) tb_temp
2020-01-02 21:40:43,743 [4740] DEBUG Servicemms_merchants - 获取实体列表
2020-01-02 21:40:43,743 [4740] DEBUG Mms - select top 20 mms_merchants.* from mms_merchants order by MerchantsCode
2020-01-02 21:40:43,749 [4740] DEBUG Mms - select count(*) from ( select mms_merchants.* from mms_merchants ) tb_temp
2020-01-02 21:40:51,315 [10088] DEBUG Servicemms_merchants - 获取实体列表
2020-01-02 21:40:51,315 [10088] DEBUG Mms - select top 20 mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '003' order by MerchantsCode
2020-01-02 21:40:51,319 [10088] DEBUG Mms - select count(*) from ( select mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '003' ) tb_temp
2020-01-02 21:40:52,524 [5952] DEBUG Servicemms_merchants - 获取新主键
2020-01-02 21:40:52,524 [5952] DEBUG Mms - select isnull(max(MerchantsCode),0) from mms_merchants  where 1 = 1 
2020-01-02 21:41:09,033 [12180] DEBUG Servicemms_merchants - 获取实体列表
2020-01-02 21:41:09,033 [12180] DEBUG Mms - select top 20 mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '010' order by MerchantsCode
2020-01-02 21:41:09,038 [12180] DEBUG Mms - select count(*) from ( select mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '010' ) tb_temp
2020-01-02 21:41:10,074 [10128] DEBUG Servicemms_merchants - 获取实体列表
2020-01-02 21:41:10,075 [10128] DEBUG Mms - select top 20 mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '008' order by MerchantsCode
2020-01-02 21:41:10,083 [10128] DEBUG Mms - select count(*) from ( select mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '008' ) tb_temp
2020-01-02 21:41:20,646 [10128] DEBUG Servicemms_merchants - 获取实体列表
2020-01-02 21:41:20,646 [10128] DEBUG Mms - select top 20 mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '002' order by MerchantsCode
2020-01-02 21:41:20,656 [10128] DEBUG Mms - select count(*) from ( select mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '002' ) tb_temp
2020-01-02 21:41:21,673 [8712] DEBUG Servicemms_merchants - 获取实体列表
2020-01-02 21:41:21,673 [8712] DEBUG Mms - select top 20 mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '004' order by MerchantsCode
2020-01-02 21:41:21,679 [8712] DEBUG Mms - select count(*) from ( select mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '004' ) tb_temp
2020-01-02 21:41:22,499 [5952] DEBUG Servicemms_merchants - 获取实体列表
2020-01-02 21:41:22,499 [5952] DEBUG Mms - select top 20 mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '008' order by MerchantsCode
2020-01-02 21:41:22,507 [5952] DEBUG Mms - select count(*) from ( select mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '008' ) tb_temp
2020-01-02 21:41:23,510 [10780] DEBUG Servicemms_merchants - 获取实体列表
2020-01-02 21:41:23,511 [10780] DEBUG Mms - select top 20 mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '009' order by MerchantsCode
2020-01-02 21:41:23,516 [10780] DEBUG Mms - select count(*) from ( select mms_merchants.* from mms_merchants where  MerchantsTypeCode =  '009' ) tb_temp
2020-01-02 22:28:53,460 [7740] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-02 22:28:53,490 [7740] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-02 22:28:53,497 [7740] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-02 22:28:53,498 [7740] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-02 22:28:53,503 [7740] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-02 22:28:53,504 [7740] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-02 22:28:54,069 [10780] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-02 22:28:57,809 [2436] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
